var Jn=Object.defineProperty,Zn=Object.defineProperties;var eo=Object.getOwnPropertyDescriptors;var en=Object.getOwnPropertySymbols;var to=Object.prototype.hasOwnProperty,no=Object.prototype.propertyIsEnumerable;var tn=(e,n,o)=>n in e?Jn(e,n,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[n]=o,i=(e,n)=>{for(var o in n||(n={}))to.call(n,o)&&tn(e,o,n[o]);if(en)for(var o of en(n))no.call(n,o)&&tn(e,o,n[o]);return e},u=(e,n)=>Zn(e,eo(n));import{r as g,j as t,b as at,u as re,a as se,c as p,B as Je,H as fe,I as we,C as fn,d as Ee,V as Ye,F as qt,D as st,T as Re,e as Se,f as oo,M as Ht,g as Ct,h as Mt,i as jt,k as zt,l as Vt,m as mn,R as dt,n as ao,o as it,p as he,q as B,S as gn,s as Ne,E as ro,t as vn,v as so,w as ce,x as io,y as co,z as Gt,A as Ae,G as lo,J as wn,L as yn,K as Cn,N as bn,O as On,P as Sn,Q as Nt,U as En,W as _n,X as bt,Y as Ot,Z as uo,_ as ho,$ as po,a0 as pt,a1 as Fe,a2 as ft,a3 as Ue,a4 as Bt,a5 as ct,a6 as fo,a7 as mo,a8 as Ft,a9 as go,aa as vo,ab as Kt,ac as xn,ad as qe,ae as He,af as Z,ag as Me,ah as ee,ai as wo,aj as yo,ak as nn,al as Co,am as bo,an as Oo,ao as Tn,ap as So,aq as Eo,ar as ke,as as mt,at as _o,au as kn,av as In,aw as Pn,ax as Rn,ay as Pe,az as Nn,aA as Wt,aB as Dn,aC as xo,aD as To,aE as ko,aF as Io,aG as Po,aH as Ln,aI as Ro,aJ as No,aK as Do,aL as on,aM as $n,aN as An,aO as Qn,aP as Un,aQ as rt,aR as Ke,aS as qn,aT as Ie,aU as Lo,aV as $o,aW as an,aX as Ao,aY as Qo,aZ as Uo,a_ as qo,a$ as Ho,b0 as Mo,b1 as jo,b2 as zo,b3 as Vo,b4 as Go,b5 as Bo,b6 as Fo,b7 as Ko}from"./vendor.30232b4b.js";const Wo=function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const l of s.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&a(l)}).observe(document,{childList:!0,subtree:!0});function o(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerpolicy&&(s.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?s.credentials="include":r.crossorigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function a(r){if(r.ep)return;r.ep=!0;const s=o(r);fetch(r.href,s)}};Wo();const _e=g.exports.createContext({user:void 0,setUser:()=>{},isAdmin:()=>!1}),Yo=({children:e})=>{const[n,o]=g.exports.useState(),a=()=>{var s,l;return((l=(s=n==null?void 0:n.data)==null?void 0:s.groups)!=null?l:[]).includes("admin")};return t(_e.Provider,{value:{user:n,setUser:o,isAdmin:a},children:e})},Xo=({children:e})=>t(Yo,{children:e});function Jo(e){const n=e.find(o=>o.key.toLowerCase()==="content-length");return n?Number.parseInt(n.value):0}const Zo=e=>{var n,o;return(o=(n=e.find(a=>a.key.toLowerCase()==="content-type"))==null?void 0:n.value)!=null?o:""};function rn(e){var l;const n=e.headers,o=Zo(n);let a=e.body;try{a=Hn(a,o)}catch(c){console.log(c)}const r=(l=e.size)!=null?l:Jo(n),s=new Date().toUTCString();return{headers:n,body:a,status:e.status,time:e.time,size:r,date:s}}const M="http://localhost:9337/";function ne(e,n,o){var r;const a=o.map(s=>{var l;return(l=e[`${n}--${s}`])!=null?l:""}).join(" ").trim();return`${(r=e[n])!=null?r:""} ${a}`.trim()}function ea(e){switch(e){case"GET":return{color:"var(--chakra-colors-green-500)"};case"POST":return{color:"var(--chakra-colors-orange-500)"};case"PUT":return{color:"var(--chakra-colors-blue-500)"};case"DELETE":return{color:"var(--chakra-colors-red-500)"};default:return{color:"var(--chakra-colors-gray-500)"}}}function Y(e,n){n({title:"Success",description:e,status:"success",isClosable:!0,duration:2e3})}function H(e,n,o,a){n({title:a!=null?a:"Error",description:e,status:"error",isClosable:!0,duration:o!=null?o:2e3})}function Hn(e,n){if(n==null?void 0:n.includes("application/json")){let o=e;o=o.replace(/\$\{([^}]+)\}/g,"/* beautify ignore:start */$&/* beautify ignore:end */");let a=at(o,{format:"json"});return a.includes("/* beautify ignore:start */")&&(a=a.replace(/\/\* beautify ignore:end \*\//g,""),a=a.replace(/(\s+)\/\* beautify ignore:start \*\//g," "),a=a.replace(/\/\* beautify ignore:start \*\//g,""),a=a.replace(/\n\s*,/g,",")),a}else{if(n==null?void 0:n.includes("application/xml"))return at(e,{format:"xml"});if(n==null?void 0:n.includes("text/html"))return at(e,{format:"html"})}return e}function ta(e){return e?e.includes("://")?e:"http://"+e:""}function Mn(e){var n;return(n=e==null?void 0:e.join(","))!=null?n:""}function St(e){const n={};return e&&e.forEach(o=>{o.key!==""&&(n[o.key]||(n[o.key]=o.value))}),n}function na(e){const n=e.pathname.split("/"),o={requestId:-1,collectionId:-1};try{return o.collectionId=parseInt(n[1]),o.requestId=parseInt(n[2]),o}catch{return o}}function sn(e){if(!e)return-1;const n=e.split(".");return n.length<2?-1:parseInt(n[1])||-1}function oa(e){return`${e}_${Date.now()}`}function aa(e){return{id:e.id,collectionId:e.collectionId,type:e.type,version:e.version,data:i({},e.data)}}const ra="_root_1qooj_1",sa="_container_1qooj_8",ia="_heading_1qooj_14",ca="_remember_1qooj_21",la="_yaadeIcon_1qooj_28",da="_oauthIcon_1qooj_32";var tt={root:ra,container:sa,heading:ia,remember:ca,yaadeIcon:la,oauthIcon:da};function ua(){const e=re(),{colorMode:n}=se(),{setUser:o}=g.exports.useContext(_e),[a,r]=g.exports.useState({username:"",password:"",loading:!1,loginProviders:[]});g.exports.useEffect(()=>{async function l(){try{r(f=>u(i({},f),{loading:!0}));const d=await fetch(M+"api/user");if(d.status!==200)throw new Error;const h=await d.json();o(h),r(f=>u(i({},f),{loading:!1}))}catch(d){console.log(d),r(h=>u(i({},h),{loading:!1}))}}async function c(){try{const d=await fetch(M+"api/loginProviders");if(d.status!==200)throw new Error;const h=await d.json();r(u(i({},a),{loginProviders:h}))}catch(d){console.log(d)}}l(),c()},[]);async function s(l){l.preventDefault();try{if(r(u(i({},a),{loading:!0})),(await fetch(M+"api/login",{method:"POST",headers:{"content-type":"application/json"},body:JSON.stringify({username:a.username,password:a.password})})).status!==200)throw new Error;o({username:"admin",id:1,version:"1.0.0",data:{settings:{saveOnSend:!0,saveOnClose:!0},groups:["admin"]}}),r(u(i({},a),{loading:!1})),Y("You are successfully logged in.",e)}catch{r(u(i({},a),{loading:!1})),H("Login was not successful.",e)}}return t("div",{className:tt.root,children:p(Je,{className:tt.container,bg:"panelBg",children:[p("div",{className:tt.heading,children:[t("img",{className:tt.yaadeIcon,src:"yaade-icon.png",alt:"yaade icon"}),t(fe,{as:"h1",size:"lg",children:"Yaade"})]}),p("form",{onSubmit:s,children:[t(we,{mt:"4",placeholder:"Username",w:"100%",borderRadius:20,size:"lg",colorScheme:"green",backgroundColor:n==="light"?"white":void 0,value:a.username,onChange:l=>r(u(i({},a),{username:l.target.value}))}),t(we,{mt:"4",placeholder:"Password",type:"password",w:"100%",borderRadius:20,size:"lg",colorScheme:"green",backgroundColor:n==="light"?"white":void 0,value:a.password,onChange:l=>r(u(i({},a),{password:l.target.value}))}),t(fn,{children:t(Ee,{mt:"6",colorScheme:"green",borderRadius:20,w:200,isLoading:a.loading,type:"submit",children:"LOGIN"})})]}),a.loginProviders.length!==0?p(Ye,{w:"100%",children:[p(qt,{align:"center",mt:"4",w:"100%",children:[t(st,{}),t(Re,{padding:"2",children:"OR"}),t(st,{})]}),a.loginProviders.map(l=>{var c;return p("form",{action:M+`api/login?providerid=${l.id}`,method:"GET",style:{width:"100%",marginTop:"16px"},children:[t("input",{style:{display:"none"},type:"text",name:"providerid",value:l.id,className:ne(tt,"search",[n])}),t(Se,{w:"100%",children:t(Ee,{"aria-label":"XX",type:"submit",variant:"outline",borderRadius:"20px",h:"46px",w:"100%",children:(c=l.label)!=null?c:`Signin with ${l.id}`})})]},l.id)})]}):null]})})}const ha={parts:["menu"],baseStyle:{menu:{zIndex:50,py:"12",background:"red"}}},pa={initialColorMode:"dark",useSystemColorMode:!1},fa=oo({config:pa,semanticTokens:{colors:{panelBg:{default:"gray.100",_dark:"gray.900"},headerBg:{default:"gray.100",_dark:"gray.900"}}},shadows:{outline:"0 !important"},components:{Menu:ha}});const De={"Content-Type":"application/json"},ma=(e,n,o)=>fetch(M+`api/collection/importOpenApi?basePath=${e}&groups=${Mn(n)}`,{method:"POST",body:o}),ga=(e,n)=>fetch(M+`api/collection/importPostman?groups=${Mn(e)}`,{method:"POST",body:n}),va=(e,n)=>fetch(M+"api/collection",{method:"POST",headers:De,body:JSON.stringify({name:e,groups:n})}),wa=(e,n)=>fetch(M+`api/collection/${e}/duplicate`,{method:"POST",headers:De,body:JSON.stringify({name:n})}),ya=(e,n)=>fetch(M+`api/collection/${e}/move`,{method:"POST",headers:De,body:JSON.stringify({newRank:n})}),Ca=(e,n)=>fetch(M+`api/request/${e}/move`,{method:"POST",headers:De,body:JSON.stringify({newRank:n})}),ba=(e,n)=>fetch(M+`api/request/${e}/move`,{method:"POST",headers:De,body:JSON.stringify({newCollectionId:n})}),Oa=(e,n)=>fetch(M+"api/request",{method:"POST",headers:De,body:JSON.stringify({collectionId:e,type:"REST",version:"1.0.0",data:n})}),Sa=e=>fetch(M+`api/collection/${e}`,{method:"DELETE"}),Ea=e=>fetch(M+`api/request/${e}`,{method:"DELETE"}),_a=e=>fetch(M+"api/request",{method:"PUT",headers:De,body:JSON.stringify(e)}),xa=(e,n)=>fetch(M+"api/invoke",{method:"POST",headers:De,body:JSON.stringify({request:e,envName:n})}),Ta=e=>fetch(M+"api/collection",{method:"PUT",headers:De,body:JSON.stringify(e)});var le={changeRequestCollection:ba,createCollection:va,duplicateCollection:wa,createRequest:Oa,deleteRequest:Ea,deleteCollection:Sa,importOpenApi:ma,importPostman:ga,moveCollection:ya,moveRequest:Ca,updateRequest:_a,invoke:xa,updateCollection:Ta};const Te=({isOpen:e,onClose:n,initialRef:o,heading:a,onClick:r,isButtonDisabled:s,buttonText:l,buttonColor:c,children:d,secondaryButtonText:h,onSecondaryButtonClick:f,hideButtonBar:m})=>{function _(R){R.preventDefault(),!s&&r()}const C=h!=null?h:"Close",y=f!=null?f:n,w=g.exports.useRef(null);return p(Ht,{isOpen:e,onClose:n,initialFocusRef:o||w,children:[t(Ct,{}),p(Mt,{children:[t(jt,{children:a}),t(zt,{}),p("form",{onSubmit:_,children:[t(Vt,{children:d}),m?t("div",{style:{marginBottom:"2rem"}}):p(mn,{children:[t(Ee,{variant:"ghost",mr:3,onClick:y,children:C}),t(Ee,{colorScheme:c,disabled:s,type:"submit",ref:w,children:l})]})]})]})]})},jn=[];var te=(e=>(e.SET="SET",e.ADD_COLLECTION="ADD_COLLECTION",e.PATCH_COLLECTION_DATA="PATCH_COLLECTION_DATA",e.DELETE_COLLECTION="DELETE_COLLECTION",e.MOVE_COLLECTION="MOVE_COLLECTION",e.ADD_REQUEST="ADD_REQUEST",e.PATCH_REQUEST_DATA="PATCH_REQUEST_DATA",e.DELETE_REQUEST="DELETE_REQUEST",e.MOVE_REQUEST="MOVE_REQUEST",e.CHANGE_REQUEST_COLLECTION="CHANGE_REQUEST_COLLECTION",e.CLOSE_ALL="CLOSE_ALL",e.TOGGLE_OPEN_COLLECTION="TOGGLE_OPEN_COLLECTION",e.SET_ENV_VAR="SET_ENV_VAR",e))(te||{});function ka(e,n){return[...e,n]}function Ia(e,n,o){const a=e.findIndex(s=>s.id===n);if(a===-1)return e;const r=[...e];return r[a].data=i(i({},r[a].data),o),r}function Pa(e,n){return e.filter(o=>o.id!==n)}function Ra(e,n,o){for(let a=0;a<e.length;a++)if(e[a].id===n){const r=[...e],s=r.splice(a,1)[0];return r.splice(o,0,s),r}return e}function Na(e,n){const o=[...e];for(let a of o)if(a.id===n.collectionId)return a.requests.push(n),o;return o}function Da(e,n,o){const a=[...e];for(const r of a)for(const s of r.requests)if(s.id===n)return s.data=i(i({},s.data),o),a;return a}function La(e,n){const o=[...e];for(const a of o){const r=a.requests.findIndex(s=>s.id===n);if(r!==-1)return a.requests.splice(r,1),o}return o}function $a(e,n,o){const a=e.findIndex(c=>c.requests.some(d=>d.id===n));if(a===-1)return e;const r=e[a].requests.findIndex(c=>c.id===n),s=[...e],l=s[a].requests.splice(r,1)[0];return s[a].requests.splice(o,0,l),s}function Aa(e,n,o){const a=e.findIndex(d=>d.requests.some(h=>h.id===n));if(a===-1)return e;const r=e[a].requests.findIndex(d=>d.id===n),s=e.findIndex(d=>d.id===o);if(s===-1)return e;const l=[...e],c=l[a].requests.splice(r,1)[0];return l[s].requests.push(c),l}function Qa(e){return e.map(n=>u(i({},n),{open:!1}))}function Ua(e,n){const o=e.findIndex(s=>s.id===n);if(o===-1)return e;const a=[...e],r=!e[o].open;return a[o]=u(i({},a[o]),{open:r}),a}function qa(e,n){var d;const o=e.findIndex(h=>h.id===n.collectionId);if(o===-1)return e;const a=[...e],r=a[o],s=(d=r.data)==null?void 0:d.envs;if(!s)return e;const l=s[n.envName];if(!l)return e;l.data[n.key]=n.value;const c=u(i({},r),{data:u(i({},r.data),{envs:u(i({},s),{[n.envName]:i({},l)})})});return a[o]=c,a}function Ha(e=jn,n){switch(n.type){case"SET":return n.collections;case"ADD_COLLECTION":return ka(e,n.collection);case"PATCH_COLLECTION_DATA":return Ia(e,n.id,n.data);case"DELETE_COLLECTION":return Pa(e,n.id);case"MOVE_COLLECTION":return Ra(e,n.id,n.newRank);case"ADD_REQUEST":return Na(e,n.request);case"PATCH_REQUEST_DATA":return Da(e,n.id,n.data);case"DELETE_REQUEST":return La(e,n.id);case"MOVE_REQUEST":return $a(e,n.id,n.newRank);case"CHANGE_REQUEST_COLLECTION":return Aa(e,n.id,n.newCollectionId);case"CLOSE_ALL":return Qa(e);case"TOGGLE_OPEN_COLLECTION":return Ua(e,n.id);case"SET_ENV_VAR":return qa(e,n.payload);default:return console.error("Invalid action type"),e}}const Ma={id:-1,ownerId:-1,version:"1.0.0",data:{},isChanged:!1};var ye=(e=>(e.SET="SET",e.UNSET="UNSET",e.SET_IS_CHANGED="SET_IS_CHANGED",e.PATCH_DATA="PATCH_DATA",e))(ye||{});function ja(e){return{id:e.id,ownerId:e.ownerId,version:e.version,data:e.data,isChanged:!1}}function za(e,n){return e&&u(i({},e),{isChanged:n})}function Va(e,n){return e&&u(i({},e),{data:i(i({},e.data),n),isChanged:!0})}function Ga(e=Ma,n){switch(n.type){case"SET":return ja(n.collection);case"UNSET":return void 0;case"PATCH_DATA":return Va(e,n.data);case"SET_IS_CHANGED":return za(e,n.isChanged);default:return console.error("Invalid action type",n),e}}function We(){var e;try{return JSON.parse((e=localStorage.getItem("selectedEnvs"))!=null?e:"{}")}catch(n){console.error(n)}return{}}function zn(e){var o,a,r;const n=We()[e.id];return n?(r=(a=(o=e.data)==null?void 0:o.envs)==null?void 0:a[n])!=null?r:{}:{}}function cn(e,n){const o=We();o[e]=n,localStorage.setItem("selectedEnvs",JSON.stringify(o))}function Vn(e,n,o,a){const r=s=>{n===s.key&&(!o||s.ctrlKey)&&(!a||s.shiftKey)&&(s.preventDefault(),e())};g.exports.useEffect(()=>(window.addEventListener("keydown",r),()=>{window.removeEventListener("keydown",r)}))}const Ba="_container_ynjag_1",Fa="_menu_ynjag_6",Ka="_iconBar_ynjag_11";var Et={container:Ba,menu:Fa,iconBar:Ka};function Wa({content:e,setContent:n}){const{colorMode:o}=se(),a=re(),r=[ao()],s=g.exports.useRef(null),{setContainer:l}=it({container:s.current,onChange:d=>n(d),extensions:[r],theme:o,value:e,style:{height:"100%"}});g.exports.useEffect(()=>{s.current&&l(s.current)},[s,l]);function c(){try{const d=at(e,{format:"js"});n(d)}catch{H("Could not format content.",a)}}return p(he,{children:[t("div",{className:Et.menu,children:p("div",{className:Et.iconBar,children:[t(B,{"aria-label":"beautify-content",isRound:!0,variant:"ghost",size:"xs",onClick:c,icon:t(gn,{})}),t(B,{"aria-label":"delete-content",isRound:!0,variant:"ghost",size:"xs",disabled:e.length===0,onClick:()=>n(""),icon:t(Ne,{})})]})}),t("div",{className:Et.container,ref:s})]})}var gt=dt.memo(Wa),Ya={};const Dt=ro.transactionFilter.of(e=>e.newDoc.lines>1?[]:e),Yt=vn(so.define([{tag:ce.moduleKeyword,cursor:"help"}])),Gn=function(e,n,o=!1){const a=Object.getOwnPropertyNames(e);["function"].forEach(l=>{if(n.includes(l))throw Error(`Script contains potentially malicious code (${l})`)});const s=[...Object.getOwnPropertyNames(window).filter(l=>l!=="eval"&&l!=="arguments")];return a.push(...s),o&&(n=`return (async function() {${n}})()`),new Function(...a,'"use strict";'+n)},Bn=function(e,n){const o=Object.values(e);return Gn(e,n).bind({})(...o)},Xa=async function(e,n){const o=Object.values(e);return await Gn(e,n,!0).bind({})(...o)},Ja=new io(co.autoSeed()),Fn=function(e,n,o,a,r=0){if(r>20)return a.push({key:e,value:"too many iterations"}),e;o&&(console.log("++++ interpolate0 ++++"),console.log("count",r),console.log("template",e),console.log("parmas",n));let s;try{s=Bn(n,"return `"+e+"`")}catch(l){return a.push({key:e,value:""+l}),o&&(console.log("error",a),console.log("---- interpolate0 ----")),e}return s.indexOf("${")>-1&&e!=s?Fn(s,n,o,a,++r):(o&&(console.log("result",s),console.log("---- interpolate0 ----")),s)},Lt=function(e,n,o,a){let r=null;if(o&&(console.log("++++ interpolate1 ++++"),console.log("obj",e)),!e)return e;if(e.constructor===Array){r=[];for(let s=0;s<e.length;s++)r.push(Lt(e[s],n,o,a))}else if(typeof e=="object"){r={};for(const[s,l]of Object.entries(e))r[s]=Lt(l,n,o,a)}else typeof e=="string"?r=Fn(e,n,o,a):r=e;return o&&(console.log("result",r),console.log("---- interpolate1 ----")),r},$t=function(e,n,o=!1){if(!e||!n)return{result:e,errors:[{key:"env",value:"request or env not defined"}]};o&&(console.log("++++ interpolate ++++"),console.log("request",e),console.log("env",n));const a=i({},n);a.$r=Ja,a.$t=Gt,a.$env=a;let r=[],s=Lt(e,a,o,r);return o&&(console.log("result",s),console.log("errors",r),console.log("---- interpolate ----")),{result:s,errors:r}},Xt=e=>lo((n,o,a)=>{let{from:r,to:s,text:l}=n.state.doc.lineAt(o);const d=n.state.tree.resolve(o);if(d&&(d.name==="Interpolation"||d.name==="Env")){let h=d.from,f=d.to;if(h==o&&a<0||f==o&&a>0)return null;if(!e)return{pos:h,end:f,above:!0,strictSide:!0,create(C){let y=document.createElement("div");return y.className="cm-tooltip-cursor",y.textContent="NO ENV SELECTED",{dom:y}}};const m=l.slice(h-r,f-r);let _="";if(m)try{const C=$t(m,e);C.errors&&C.errors.length>0?_="UNKNOWN":_=C.result}catch{_="ERROR"}return{pos:h,end:f,above:!0,strictSide:!0,create(C){let y=document.createElement("div");return y.className="cm-tooltip-cursor",y.textContent=_,{dom:y}}}}}),Jt=Ae.baseTheme({".cm-tooltip-cursor":{backgroundColor:"#66b",color:"white",border:"none",padding:"2px 7px",borderRadius:"4px"},".cm-tooltip":{borderRadius:"4px",border:0}}),Za=wn({Interpolation:ce.moduleKeyword,"InterpolationStart InterpolationEnd":ce.moduleKeyword}),er=yn.deserialize({version:14,states:"#SQQOSOOO]OPO'#C_OOOO'#Ce'#CeOOOO'#Cb'#CbQQOSOOOhOQO'#CiOOOO'#Cc'#CcO]OPO,58yOOOO'#Ca'#CaOOOO,58y,58yOOOO-E6`-E6`OOOO,59T,59TOsOQO,59TOOOO-E6a-E6aOOOO1G.e1G.eOOOO1G.o1G.o",stateData:"!O~OQQOSPOYQO~OZWO[UO^TO~O[UO^TO_ZO~O[UO^TO__O~O",goto:"!T^PPP_PcioPyPPP}TQOSQXPR^VQSORYSQVPQ[TT]V[TROSXUPTV[",nodeNames:"\u26A0 Value Escape Interpolation InterpolationStart InterpolationEnd",maxTerm:15,nodeProps:[["closedBy",4,"InterpolationEnd"],["openedBy",5,"InterpolationStart"]],propSources:[Za],skippedNodes:[0],repeatNodeCount:2,tokenData:"y~RVXYhYZh]^hpqhq#oh#o#pm#q#rr~mO[~~rO^~UyOZQ_S",tokenizers:[1,2,new Cn("#[~RQtuX#O#Pd~[P#o#p_~dOS~~gXrs!S!P!Q!S#O#P!S#U#V!S#Y#Z!S#b#c!S#f#g!S#h#i!S#i#j!X~!XOQ~~![R!Q![!e!c!i!e#T#Z!e~!hR!Q![!q!c!i!q#T#Z!q~!tR!Q![!}!c!i!}#T#Z!}~#QR!Q![!S!c!i!S#T#Z!S~",103,10)],topRules:{Value:[0,1]},tokenPrec:0}),tr=bn.define({name:"json",parser:er});function Kn(e){const n={};n[".cm-line::selection, .cm-line > span::selection, .cm-line > span > span::selection"]={backgroundColor:e==="dark"?"#5e7aa3 !important":"#b3d7fe !important"};const o=Ae.theme(n);return new On(tr,[o])}const Qe={"&":{color:"#000",boxSizing:"border-box",fontFamily:"Arial, sans-serif",fontSize:"16px",height:"auto",overflow:"hidden",border:"1px solid var(--chakra-colors-gray-700)",backgroundColor:"--var(--chakra-colors-gray-900)"},"&.cm-focused":{outline:"1px solid #38A169 !important",outlineOffset:"-1px"},".cm-cursor":{borderLeft:"1px solid #000"},".cm-placeholder":{color:"#4e5057",lineHeight:"30px"},".cm-gutters":{display:"none"},".cm-linenumber":{display:"none"},".cm-content":{minHeight:"30px",height:"30px",padding:"0",boxSizing:"border-box",margin:"auto",verticalAlign:"middle"},".cm-content, .cm-gutter":{minHeight:"30px"},".cm-scrollbar":{display:"none"},".cm-scroller":{overflow:"hidden",fontFamily:"Arial, sans-serif"},".cm-activeLineGutter":{display:"none"},".cm-line":{paddingLeft:"10px",paddingRight:"10px",minHeight:"30px",height:"30px",boxSizing:"border-box",lineHeight:"1.8"}},Wn=u(i({},Qe),{"&":u(i({},Qe["&"]),{border:"1px solid var(--chakra-colors-gray-700)"})}),nr=u(i({},Qe),{"&":u(i({},Qe["&"]),{border:"1px solid white"}),".cm-activeLine":{backgroundColor:"white"}}),or=Ae.theme(Wn),ar=Ae.theme(nr),At=Sn({theme:"dark",settings:{background:"#171923",foreground:"white",caret:"white",selection:"#5e7aa3",selectionMatch:"#036dd626",lineHighlight:"#171923",gutterBackground:"#fff",gutterForeground:"#8a919966"},styles:[{tag:ce.moduleKeyword,color:"#c678dd"}]}),Qt=Sn({theme:"light",settings:{background:"#fff",foreground:"black",caret:"black",selection:"#b3d7fe",selectionMatch:"#036dd626",gutterBackground:"#fff",gutterForeground:"#8a919966"},styles:[{tag:ce.moduleKeyword,color:"#c678dd"}]}),rr="_row_124f1_1",sr="_cm_124f1_9",ir="_input_124f1_15",cr="_inputcmleft_124f1_36",lr="_inputcmright_124f1_41",dr="_checkbox_124f1_62";var Oe={row:rr,cm:sr,input:ir,"input--left":"_input--left_124f1_26","input--right":"_input--right_124f1_31",inputcmleft:cr,inputcmright:lr,"input--light":"_input--light_124f1_46","input--dark":"_input--dark_124f1_54",checkbox:dr,"checkbox--light":"_checkbox--light_124f1_66","inputDisabled--light":"_inputDisabled--light_124f1_70","inputDisabled--dark":"_inputDisabled--dark_124f1_74"};const vt=u(i({},Wn),{".cm-placeholder":u(i({},Qe[".cm-placeholder"]),{lineHeight:"38px"}),".cm-content":u(i({},Qe[".cm-content"]),{minHeight:"38px",height:"38px"}),".cm-line":u(i({},Qe[".cm-line"]),{lineHeight:"2.4",paddingLeft:"1rem",paddingRight:"1rem"})}),wt=u(i({},vt),{"&":u(i({},vt["&"]),{width:"100%",minWidth:"100%",borderRadius:"8px 0 0 8px"})}),ur=u(i({},wt),{"&":u(i({},wt["&"]),{border:"1px solid var(--chakra-colors-gray-700)",borderRight:"1px solid #2D3748"})}),hr=u(i({},wt),{"&":u(i({},wt["&"]),{border:"1px solid #EDF2F7"}),".cm-activeLine":{backgroundColor:"white"}}),yt=u(i({},vt),{"&":u(i({},vt["&"]),{width:"100%",minWidth:"100%",borderRadius:"0 8px 8px 0"})}),pr=u(i({},yt),{"&":u(i({},yt["&"]),{border:"1px solid var(--chakra-colors-gray-700)",borderLeft:"1px solid #2D3748"})}),fr=u(i({},yt),{"&":u(i({},yt["&"]),{border:"1px solid #EDF2F7"}),".cm-activeLine":{backgroundColor:"white"}}),mr=Ae.theme(hr),gr=Ae.theme(ur),vr=Ae.theme(fr),wr=Ae.theme(pr);function yr({i:e,name:n,kKey:o,value:a,isEnabled:r=!0,canDisableRow:s=!1,onChangeRow:l,onDeleteRow:c,isDeleteDisabled:d,isEnableDisabled:h,readOnly:f,hasEnvSupport:m,env:_}){const{colorMode:C}=se(),y=g.exports.useRef(null),w=g.exports.useRef(null),R=[Dt],E=[Dt];if(m!=="NONE"){const k=[];k.push(Kn(C)),k.push(Xt(_==null?void 0:_.data)),k.push(Yt),k.push(Jt),m==="BOTH"?(R.push(...k),E.push(...k)):m==="VALUE_ONLY"&&E.push(...k)}const{setContainer:A}=it({container:y.current,onChange:k=>l.current(e,"key",k),extensions:[C==="light"?mr:gr,...R,Nt()],theme:C==="light"?Qt:At,value:o,style:{height:"100%"},placeholder:"Key",indentWithTab:!1,basicSetup:!1}),{setContainer:P}=it({container:w.current,onChange:k=>l.current(e,"value",k),extensions:[C==="light"?vr:wr,...E,Nt()],theme:C==="light"?Qt:At,value:a,style:{height:"100%"},placeholder:"Value",indentWithTab:!1,basicSetup:!1});return g.exports.useEffect(()=>{y.current&&A(y.current)},[e,y,n,A]),g.exports.useEffect(()=>{w.current&&P(w.current)},[e,n,w,P]),t("div",{className:Oe.row,children:f?p(he,{children:[t("input",{className:`${Oe.input} ${Oe["input--left"]} ${Oe[`input--${C}`]}`,placeholder:"Key",value:o,readOnly:f}),t("input",{className:`${Oe.input} ${Oe["input--right"]} ${Oe[`input--${C}`]}`,placeholder:"Value",value:a,readOnly:f})]}):p(he,{children:[t("div",{className:`${Oe.cm} ${r?"":ne(Oe,"inputDisabled",[C])}`,ref:y}),t("div",{className:`${Oe.cm} ${r?"":ne(Oe,"inputDisabled",[C])}`,ref:w}),s&&t(En,{className:ne(Oe,"checkbox",[C]),disabled:h,isChecked:r,onChange:k=>l.current(e,"isEnabled",k.target.checked),colorScheme:"green"}),t(B,{"aria-label":"delete-row",isRound:!0,variant:"ghost",disabled:d,onClick:()=>c.current(e),colorScheme:"red",icon:t(Ne,{})})]})},`${n}-${e}`)}var Cr=dt.memo(yr);const br={key:"",value:""},_t=e=>e.key===""&&e.value==="";function lt({name:e,kvs:n,setKvs:o,readOnly:a,canDisableRows:r=!1,hasEnvSupport:s,env:l}){const c=g.exports.useMemo(()=>{const f=n?[...n]:[];return!a&&(f.length===0||!_t(f[f.length-1]))&&f.push(i({},br)),f},[n,a]),d=g.exports.useRef((f,m,_)=>{}),h=g.exports.useRef(f=>{});return g.exports.useEffect(()=>{d.current=(f,m,_)=>{let C=[...c];const y=i({},C[f]);y[m]=_,C[f]=y,C=C.filter(w=>!_t(w)),o(C)}},[c,o]),g.exports.useEffect(()=>{h.current=f=>{let m=[...c];m.splice(f,1),m=m.filter(_=>!_t(_)),o(m)}},[c,o]),t("div",{className:Ya.container,children:c.map(({key:f,value:m,isEnabled:_},C)=>t(Cr,{name:`${e}-${C}`,i:C,kKey:f,value:m,isEnabled:_,onChangeRow:d,canDisableRow:r,onDeleteRow:h,isEnableDisabled:r&&!f&&!m,isDeleteDisabled:!f&&!m?!0:a,readOnly:a,hasEnvSupport:s,env:l},`${e}-${C}`))})}const Or="_box_jcg3h_1",Sr="_input_jcg3h_8";var ln={box:Or,input:Sr,"input--light":"_input--light_jcg3h_15","input--dark":"_input--dark_jcg3h_19"};const Xe=({groups:e,setGroups:n,isRounded:o,className:a})=>{const[r,s]=g.exports.useState(""),{colorMode:l}=se();function c(h){if(h.endsWith(" ")){const f=Array.from(new Set([...e,h.trim()]));h!==" "&&n(f),s("")}else s(h)}function d(h){const f=e.filter(m=>m!==h);n(f)}return p(Ye,{alignItems:"start",width:"100%",className:a,children:[t(we,{size:o?"md":"sm",borderRadius:o?"20px":void 0,placeholder:"Groups",value:r,onChange:h=>c(h.target.value),backgroundColor:l==="light"?"white":void 0}),t(_n,{children:e.map(h=>p(bt,{size:"sm",borderRadius:"full",variant:"solid",colorScheme:"green",mx:"0.25rem",my:"0.2rem",children:[t(Ot,{children:h}),t(uo,{onClick:()=>d(h)})]},`collection-group-list-${h}`))})]})},Er="_grid_1vdmo_1";var _r={grid:Er};function xr({groups:e,setGroups:n,settings:o,setSettings:a}){var s,l;function r(c,d){a(u(i({},o),{webClientOptions:u(i({},o==null?void 0:o.webClientOptions),{[c]:d})}))}return p("div",{className:_r.grid,children:[t("div",{children:"Groups"}),t(Xe,{groups:e,setGroups:n,isRounded:!0}),p("div",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[t("p",{children:"Web Client Options"}),t(ho,{label:"Only applies for the server proxy",fontSize:"md",children:t(po,{})})]}),p("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[t(pt,{colorScheme:"green",size:"md",onChange:c=>r("verifyHost",c.target.checked),isChecked:((s=o==null?void 0:o.webClientOptions)==null?void 0:s.verifyHost)===void 0?!0:o.webClientOptions.verifyHost,children:"Verify Host"}),t(pt,{colorScheme:"green",size:"md",onChange:c=>r("trustAll",c.target.checked),isChecked:!!((l=o==null?void 0:o.webClientOptions)==null?void 0:l.trustAll),children:"Trust All"})]})]})}const Tr="_row_i50bm_1",kr="_input_i50bm_8";var ve={row:Tr,input:kr,"input--left":"_input--left_i50bm_18","input--right":"_input--right_i50bm_23","input--light":"_input--light_i50bm_28","input--dark":"_input--dark_i50bm_36"};const dn={data:{},proxy:"ext",secretKeys:[]},nt="*******",Ir=({collectionId:e,envs:n,setEnvs:o})=>{var T,z,J,me;const[a,r]=g.exports.useState({modalState:"default",newEnvName:"",newSecretKey:"",newSecretValue:"",selectedEnvKVs:[],selectedEnvSecrets:[]}),[s,l]=g.exports.useState(),{colorMode:c}=se(),d=re(),h=g.exports.useRef(null),f=g.exports.useRef({}),[m,_]=g.exports.useState(Object.keys(n!=null?n:{})),[C,y]=g.exports.useState(We());g.exports.useEffect(()=>{f.current=n,_(Object.keys(n!=null?n:{}))},[n]);const w=v=>{var S;return v&&(S=f.current[v])!=null?S:dn},R=g.exports.useCallback(()=>{l(void 0),r(v=>u(i({},v),{selectedEnvKVs:void 0,selectedEnvSecrets:[]}))},[]),E=g.exports.useCallback(v=>{var de,xe;const S=w(v),q=(de=S==null?void 0:S.secretKeys)!=null?de:[],ie=A((xe=S.data)!=null?xe:{}),G=q.map(Ce=>({key:Ce,value:nt,isChanged:!1}));r(Ce=>u(i({},Ce),{selectedEnvKVs:ie,selectedEnvSecrets:G})),l(v),cn(e,v)},[e]);g.exports.useEffect(()=>{const v=We()[e];if(v&&m.includes(v)){l(v);return}let S=m.find(q=>q===C[e]);if(!S&&m.length!==0&&(S=m[0]),S){E(S);return}R()},[e,m,E,f,C,R]),g.exports.useEffect(()=>{var q;if(!s)return;const v=f.current[s],S=(q=v==null?void 0:v.secretKeys)!=null?q:[];!v||r(ie=>u(i({},ie),{modalState:"default",selectedEnvName:We()[e],selectedEnvKVs:A(v.data),selectedEnvSecrets:S.map(G=>({key:G,value:nt,isChanged:!1}))}))},[e,s]),g.exports.useEffect(()=>{var v;["create","copy"].includes(a.modalState)&&((v=h.current)==null||v.focus())},[a.modalState]);function A(v){return Object.keys(v).length===0?[{key:"",value:""}]:Object.entries(v).map(([S,q])=>({key:S,value:q}))}async function P(){var v,S;try{let q={method:"POST"};const ie=(v=w(a.envNameToCopy))!=null?v:{},G=JSON.parse(JSON.stringify((S=ie.data)!=null?S:{})),de=ie.proxy;if(a.modalState==="copy"){const $={data:G,proxy:de};q.body=JSON.stringify($)}if((await fetch(M+`api/collection/${e}/envs/${a.newEnvName}`,q)).status!==200)throw Error();const Ce=a.modalState==="copy"?G:{};o(u(i({},n),{[a.newEnvName]:{data:Ce,proxy:de,secretKeys:[]}})),cn(e,a.newEnvName),r(u(i({},a),{newEnvName:"",modalState:"default",selectedEnvSecrets:[],envNameToCopy:void 0})),l(a.newEnvName),y(u(i({},C),{[e]:a.newEnvName})),Y("Environment created.",d)}catch{H("Could not create environment",d)}}async function k(){try{if(!s||m.length<=1||(await fetch(M+`api/collection/${e}/envs/${s}`,{method:"DELETE"})).status!==200)throw Error();const S=n!=null?n:{};delete S[s];const q=Object.keys(S);o(S),_(q),E(q[0]),Y("Environment deleted",d)}catch{H("Could not delete environment",d)}}function j(v){if(!s)return;r(u(i({},a),{selectedEnvKVs:v}));const S=St(v),q=w(s);o(u(i({},n),{[s]:u(i({},q),{data:S})}))}function D(v){if(!s)return;const S=w(s);o(u(i({},n),{[s]:u(i({},S),{proxy:v})}))}function X(){return a.newEnvName===""||m.includes(a.newEnvName)||a.newEnvName.includes("__")||a.newEnvName.includes(" ")}async function b(){try{if((await fetch(M+`api/collection/${e}/envs/${s}/secrets/${a.newSecretKey}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:a.newSecretValue})})).status!==200)throw Error();pe(a.newSecretKey),Y("Secret created",d)}catch{H("Failed to create secret",d)}}function Q(){r(u(i({},a),{newSecretKey:"",newSecretValue:""}))}async function oe(v){try{if(!a.selectedEnvSecrets)return;const S=i({},a.selectedEnvSecrets[v]);if((await fetch(M+`api/collection/${e}/envs/${s}/secrets/${S.key}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({value:S.value})})).status!==200)throw Error();S.value=nt,S.isChanged=!1,O(v,S),Y("Secret saved",d)}catch{H("Failed to set secret",d)}}async function N(v){try{if(!a.selectedEnvSecrets)return;const S=i({},a.selectedEnvSecrets[v]);if((await fetch(M+`api/collection/${e}/envs/${s}/secrets/${S.key}`,{method:"DELETE"})).status!==200)throw Error();I(v),Y("Secret deleted",d)}catch{H("Failed to delete secret",d)}}function pe(v){if(!a.selectedEnvSecrets||!s)return;const S={key:v,value:nt,isChanged:!1},q=w(s),ie=[...a.selectedEnvSecrets,S],G=ie.map(de=>de.key);r(u(i({},a),{selectedEnvSecrets:ie,newSecretKey:"",newSecretValue:""})),o(u(i({},n),{[s]:u(i({},q),{secretKeys:G})}))}function O(v,S){if(!a.selectedEnvSecrets)return;const q=[...a.selectedEnvSecrets];q[v]=S,r(u(i({},a),{selectedEnvSecrets:q}))}function I(v){if(!a.selectedEnvSecrets||!s)return;const S=w(s),q=[...a.selectedEnvSecrets];q.splice(v,1),r(u(i({},a),{selectedEnvSecrets:q}));const ie=q.map(G=>G.key);o(u(i({},n),{[s]:u(i({},S),{secretKeys:ie})}))}function U(v){if(!a.selectedEnvSecrets)return;const S=i({},a.selectedEnvSecrets[v]);S.isChanged=!0,S.value="",O(v,S)}function L(v,S){if(!a.selectedEnvSecrets)return;const q=i({},a.selectedEnvSecrets[v]);q.value=S,O(v,q)}function F(v){if(!a.selectedEnvSecrets)return;const S=i({},a.selectedEnvSecrets[v]);S.value=nt,S.isChanged=!1,O(v,S)}function W(){return a.newSecretKey===""||a.newSecretValue===""?!0:a.selectedEnvSecrets.map(v=>v.key).includes(a.newSecretKey)}function x(){return a.newSecretKey===""&&a.newSecretValue===""}return p("div",{children:[a.modalState==="create"||a.modalState==="copy"?p(Se,{children:[t(we,{placeholder:"Name",w:"100%",borderRadius:20,colorScheme:"green",backgroundColor:c==="light"?"white":void 0,value:a.newEnvName,ref:h,onChange:v=>r(u(i({},a),{newEnvName:v.target.value})),onKeyDown:v=>{v.key==="Enter"&&v.preventDefault()}}),t(B,{icon:t(Fe,{}),variant:"ghost",colorScheme:"green","aria-label":"Create new environment",disabled:X(),onClick:P}),t(B,{icon:t(ft,{}),variant:"ghost",colorScheme:"red","aria-label":"Close form to create new environment",onClick:()=>r(u(i({},a),{modalState:"default",newEnvName:""}))})]}):p(Se,{children:[t(Ue,{w:"100%",borderRadius:20,colorScheme:"green",backgroundColor:c==="light"?"white":void 0,onChange:v=>E(v.target.value),value:s,children:m.map(v=>t("option",{children:v},`${e}-${v}`))}),t(B,{icon:t(Bt,{}),variant:"ghost","aria-label":"Open form to create new environment",onClick:()=>r(u(i({},a),{modalState:"create"})),marginInlineStart:"0"}),t(B,{icon:t(ct,{}),variant:"ghost","aria-label":"Open form to create new environment",onClick:()=>r(u(i({},a),{modalState:"copy",envNameToCopy:s,newEnvName:`${s}-copy`})),disabled:!s,marginInlineStart:"0"}),t(B,{icon:t(Ne,{}),variant:"ghost",colorScheme:"red",disabled:!s||m.length<=1,"aria-label":"Open form to create new environment",onClick:k,marginInlineStart:"0"})]}),s?p("div",{style:{overflow:"auto"},children:[t(fe,{as:"h6",size:"xs",my:"4",children:"Proxy"}),p(Ue,{w:"100%",borderRadius:20,colorScheme:"green",backgroundColor:c==="light"?"white":void 0,onChange:v=>D(v.target.value),value:(z=(T=n[s])==null?void 0:T.proxy)!=null?z:"ext",children:[t("option",{value:"ext",children:"Extension"}),t("option",{value:"server",children:"Server"})]}),t(fe,{as:"h6",size:"xs",my:"4",children:"Variables"}),t(lt,{name:"env",kvs:(J=a.selectedEnvKVs)!=null?J:[],setKvs:v=>j(v),hasEnvSupport:"NONE"}),((me=n[s])==null?void 0:me.proxy)==="server"?p(he,{children:[t(Se,{children:t(fe,{as:"h6",size:"xs",my:"4",children:"Secrets"})}),p("div",{className:ve.row,style:{marginBottom:"1rem"},children:[t("input",{className:`${ve.input} ${ve["input--left"]} ${ve[`input--${c}`]}`,placeholder:"Key",value:a.newSecretKey,onChange:v=>r(u(i({},a),{newSecretKey:v.target.value}))}),t("input",{className:`${ve.input} ${ve["input--right"]} ${ve[`input--${c}`]}`,placeholder:"Value",value:a.newSecretValue,onChange:v=>r(u(i({},a),{newSecretValue:v.target.value}))}),t(B,{"aria-label":"add-secret",isRound:!0,variant:"ghost",disabled:W(),colorScheme:"green",icon:t(Fe,{}),onClick:b}),t(B,{"aria-label":"clear-secret",isRound:!0,variant:"ghost",disabled:x(),colorScheme:"red",icon:t(fo,{}),onClick:Q})]}),a.selectedEnvSecrets.map((v,S)=>p("div",{className:ve.row,children:[t("input",{className:`${ve.input} ${ve["input--left"]} ${ve[`input--${c}`]}`,placeholder:"Key",value:v.key,readOnly:!0}),t("input",{className:`${ve.input} ${ve["input--right"]} ${ve[`input--${c}`]}`,placeholder:"Value",value:v.value,readOnly:!v.isChanged,onClick:()=>U(S),onChange:q=>L(S,q.target.value)}),t(B,{"aria-label":"edit-row",disabled:!v.isChanged||v.value==="",isRound:!0,variant:"ghost",colorScheme:"green",icon:t(Fe,{}),onClick:()=>oe(S)}),v.isChanged?t(B,{"aria-label":"cancel-edit-row",disabled:!v.isChanged,isRound:!0,variant:"ghost",colorScheme:"red",onClick:()=>F(S),icon:t(ft,{})}):t(B,{"aria-label":"delete-secret-row",isRound:!0,variant:"ghost",onClick:()=>N(S),colorScheme:"red",icon:t(Ne,{})})]},`secret-${S}`)),t("div",{style:{minHeight:"20px"}})]}):null]}):null]})};const Pr="_root_t9cia_1",Rr="_btn_t9cia_10";var xt={root:Pr,btn:Rr};function Yn({description:e,setDescription:n}){var m;const[o,a]=g.exports.useState({rawDescription:"",isEditDescription:!1}),{colorMode:r}=se(),s=r==="dark"?"dark":"light",l=[mo()];function c(){a(u(i({},o),{isEditDescription:!0,rawDescription:e}))}function d(){a(u(i({},o),{isEditDescription:!1,rawDescription:""}))}function h(){n(o.rawDescription),a(u(i({},o),{isEditDescription:!1}))}function f(_){a(u(i({},o),{rawDescription:_}))}return p("div",{className:xt.root,children:[o.isEditDescription?t(Ft,{onChange:f,extensions:l,theme:r,value:(m=o.rawDescription)!=null?m:"",style:{height:"100%"}}):t(go,{className:`markdown-body--${s}`,remarkPlugins:[vo],children:e}),o.isEditDescription?p("span",{className:xt.btn,children:[t(B,{icon:t(Fe,{}),variant:"ghost",colorScheme:"green","aria-label":"Save description",onClick:h}),t(B,{icon:t(ft,{}),variant:"ghost",colorScheme:"red","aria-label":"Cancel edit description",onClick:d})]}):t("span",{className:xt.btn,children:t(B,{icon:t(Kt,{}),variant:"ghost","aria-label":"Edit description",onClick:c})})]})}function Nr({currentCollection:e,dispatchCurrentCollection:n,dispatchCollections:o,tabIndex:a,setTabIndex:r}){var A,P,k,j,D,X,b;const{colorMode:s}=se(),l=re(),c=e?zn(e):null,d=((A=e.data)==null?void 0:A.headers)&&e.data.headers.length!==0?e.data.headers:[{key:"",value:"",isEnabled:!0}],h=async()=>{try{if((await fetch(M+"api/collection",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).status!==200)throw new Error;o({type:te.PATCH_COLLECTION_DATA,id:e.id,data:e.data}),n({type:ye.SET_IS_CHANGED,isChanged:!1}),Y("Collection was saved.",l)}catch{H("The collection could not be saved.",l)}},f=Q=>n({type:ye.PATCH_DATA,data:{name:Q}}),m=Q=>n({type:ye.PATCH_DATA,data:{description:Q}}),_=Q=>n({type:ye.PATCH_DATA,data:{envs:Q}}),C=Q=>n({type:ye.PATCH_DATA,data:{headers:Q}}),y=Q=>n({type:ye.PATCH_DATA,data:{requestScript:Q}}),w=Q=>n({type:ye.PATCH_DATA,data:{responseScript:Q}}),R=Q=>n({type:ye.PATCH_DATA,data:{groups:Q}}),E=Q=>n({type:ye.PATCH_DATA,data:{settings:Q}});return Vn(h,"s",!0),p(Je,{className:ln.box,bg:"panelBg",h:"100%",children:[p("div",{style:{display:"flex"},children:[t("input",{className:ne(ln,"input",[s]),type:"text",placeholder:"Name",value:(P=e.data.name)!=null?P:"",onChange:Q=>f(Q.target.value)}),t(B,{"aria-label":"start-rename-button",icon:t(xn,{}),variant:"ghost",size:"sm",ml:"2",disabled:!e.isChanged,onClick:h})]}),p(qe,{isLazy:!0,index:a,onChange:Q=>r(Q),colorScheme:"green",mt:"1",display:"flex",flexDirection:"column",maxHeight:"100%",h:"100%",mb:"4",children:[p(He,{children:[t(Z,{children:"Description"}),t(Z,{children:"Environments"}),t(Z,{children:"Headers"}),t(Z,{children:"Request Script"}),t(Z,{children:"Response Script"}),t(Z,{children:"Settings"})]}),p(Me,{overflowY:"auto",sx:{scrollbarGutter:"stable"},h:"100%",children:[t(ee,{h:"100%",children:t(Yn,{description:(k=e.data.description)!=null?k:"",setDescription:m})}),t(ee,{children:t(Ir,{collectionId:e.id,envs:(j=e.data.envs)!=null?j:{},setEnvs:_})}),t(ee,{children:t(lt,{name:"headers",kvs:d,setKvs:C,canDisableRows:!0,hasEnvSupport:"BOTH",env:c})}),t(ee,{h:"100%",children:t(gt,{content:(D=e.data.requestScript)!=null?D:"",setContent:y})}),t(ee,{h:"100%",children:t(gt,{content:(X=e.data.responseScript)!=null?X:"",setContent:w})}),t(ee,{h:"100%",children:t(xr,{groups:(b=e.data.groups)!=null?b:[],setGroups:R,settings:e.data.settings,setSettings:E})})]})]})]})}const Ut={id:-1,collectionId:-1,type:"REST",version:"1.0.0",data:{name:"",uri:"",method:"GET",headers:[{key:"",value:""}],body:""},isChanged:!1,isLoading:!1};var ae=(e=>(e.SET="SET",e.UNSET="UNSET",e.PATCH_DATA="PATCH_DATA",e.SET_IS_LOADING="SET_IS_LOADING",e.SET_IS_CHANGED="SET_IS_CHANGED",e))(ae||{});function Dr(e){return{id:e.id,collectionId:e.collectionId,type:e.type,version:e.version,data:e.data,isChanged:!1,isLoading:!1}}function Lr(e,n){return e&&u(i({},e),{data:i(i({},e.data),n),isChanged:!0})}function $r(e,n){return e&&u(i({},e),{isLoading:n})}function Ar(e,n){return e&&u(i({},e),{isChanged:n})}function Qr(e=Ut,n){switch(n.type){case"SET":return Dr(n.request);case"UNSET":return void 0;case"PATCH_DATA":return Lr(e,n.data);case"SET_IS_LOADING":return $r(e,n.isLoading);case"SET_IS_CHANGED":return Ar(e,n.isChanged);default:return console.error("Invalid action type"),e}}const Xn=function(e,n){let o=n;return typeof n=="string"&&(o=JSON.parse(n)),wo.value(o,e)};function Ur(e,n,o,a,r,s,l,c){const d={};d.env={set:a,get:r},d.res={body:n.body,headers:St(n.headers),status:n.status},d.jp=Xn,d.DateTime=Gt,l?d.log=(...h)=>console.log(`[Collection Response Script: ${e.collectionId} - ${c!=null?c:"NO_ENV"}]`,...h):d.log=(...h)=>console.log(`[Response Script: ${e.id} - ${c!=null?c:"NO_ENV"}]`,...h);try{Bn(d,o)}catch(h){console.log(h),H(`${h}`,s,5e3,"Error in response script")}}async function qr(e,n,o,a,r,s,l){var d;const c={};c.env={set:o,get:a,name:l},c.req={uri:e.data.uri,body:e.data.body,method:e.data.method,headers:St((d=e.data.headers)!=null?d:[])},c.jp=Xn,c.DateTime=Gt,c.exec=r,s?c.log=(...h)=>console.log(`[Collection Request Script: ${e.collectionId} - ${l!=null?l:"NO_ENV"}]`,...h):c.log=(...h)=>console.log(`[Request Script: ${e.id} - ${l!=null?l:"NO_ENV"}]`,...h);try{await Xa(c,n)}catch(h){const f=h.message.startsWith("Error in request script")?h.message:`Error in request script [id: ${e.id}]: ${h}`;throw Error(f)}}const Hr=wn({String:ce.string,Number:ce.number,"True False":ce.bool,PropertyName:ce.propertyName,Null:ce.null,TemplateString:ce.string,PropertyTemplateString:ce.propertyName,",":ce.separator,"[ ]":ce.squareBracket,StringEnv:ce.bool,Env:ce.moduleKeyword,Interpolation:ce.moduleKeyword,"InterpolationStart InterpolationEnd  EnvStart EnvEnd":ce.moduleKeyword,Escape:ce.number}),Mr=yn.deserialize({version:14,states:"'tOVQPOOOqQPO'#CbOyQPO'#ClOOQO'#Co'#CoO!QQQO'#CnOOQO'#Cx'#CxQOQPOOO!]OWO'#CmOOQO'#Cd'#CdO!kQPO'#CcO!pQPO'#C{OOQO,58|,58|O!xQPO,58|O!}OWO'#CeO#]QPO'#DWOOQO,59W,59WO#eQPO,59WO#jQSO'#DQOOQO'#Cr'#CrO!QQQO,59YOOQO'#Cp'#CpOOQO,59Y,59YO#uQQO'#CgOOOO'#Cq'#CqO$QOWO,59XOOQO,59X,59XOVQPO,58}OtQPO'#CsO$`QPO,59gOOQO1G.h1G.hO$hOWO,59POOQO,59P,59POVQPO'#CtO$vQPO,59rOOQO1G.r1G.rOOQO,59l,59lO%OQSO,59lOOQO-E6p-E6pOOQO1G.t1G.tO#uQQO,59ROOOO'#Ci'#CiOOOO,59R,59ROOOO-E6o-E6oOOQO1G.s1G.sOOQO1G.i1G.iOOQO,59_,59_OOQO-E6q-E6qOOQO1G.k1G.kOOQO,59`,59`OOQO-E6r-E6rOOQO1G/W1G/WOOOO1G.m1G.m",stateData:"%Z~OkOS~OQTORTOSTOTTO_QOnPOpVO{RO~OmZOp]O~O^_O~PVOrdOsbOuaO~OYgO[fOqgOwiO~OxjO~OykOmoX~OmmO~OYgO[fOqgOwoO~OypO^zX~O^rO~OsbOuaOvsO~OrxOsbOuaO~OYgO[fOqgOw{O~OykOmoa~OYgO[fOqgOw!PO~OypO^za~OsbOuaOv!SO~O",goto:"$[{PPPPPP|!S!Y!^P!bP!hPP|||!n!t!z#U#d#jPPP#pPP#|PPPP$PPPPPP$XXTOQjpQYPR}kTXPkTWPkXgV]hnQyfR!TwXSOQjpQeSRvcQhVQn]TzhnQcSQtaUuctwRwfQlYR!OlQq^R!RqQUOQ^QQ|jR!QpR[P]bSacftwR`Q",nodeNames:"\u26A0 JsonText True False Null Number Object Property PropertyName PropertyTemplateString Escape Interpolation InterpolationStart InterpolationEnd ] [ Array TemplateString Env EnvStart EnvEnd",maxTerm:43,nodeProps:[["closedBy",12,"InterpolationEnd",15,"]",19,"EnvEnd"],["openedBy",13,"InterpolationStart",14,"[",20,"EnvStart"]],propSources:[Hr],skippedNodes:[0],repeatNodeCount:4,tokenData:"({~RlXY!yYZ!y]^!ypq!yqr#Ors#Tst#Otu#[u|#O|}#i}!O#p!O!Q#O!Q!R%l!R![%|![!]&a!]!}#O!}#O&h#O#P#O#P#Q&o#Q#Y#O#Y#Z&v#Z#b#O#b#c'g#c#h#O#h#i(Q#i#o#O#o#p(k#q#r(r~#OOk~[#TOs[^#[OpQs[^#aPs[#o#p#dQ#iO{Q^#pOyQs[^#uQs[!Q!R#{!R![%ZQ$QRTQ!O!P$Z!g!h$o#X#Y$oQ$^P!Q![$aQ$fRTQ!Q![$a!g!h$o#X#Y$oQ$rR{|${}!O${!Q![%RQ%OP!Q![%RQ%WPTQ!Q![%RQ%`STQ!O!P$Z!Q![%Z!g!h$o#X#Y$o^%sRTQs[!O!P$Z!g!h$o#X#Y$o^&TSTQs[!O!P$Z!Q![%Z!g!h$o#X#Y$o^&hOxQs[^&oO_Qs[^&vO^Qs[^&{Ps[#T#U'OQ'RP#`#a'UQ'XP#g#h'[Q'_P#X#Y'bQ'gORQ^'lPs[#i#j'oQ'rP#`#a'uQ'xP#`#a'{Q(QOSQ^(VPs[#f#g(YQ(]P#i#j(`Q(cP#X#Y(fQ(kOQQ^(rOu[nQ^({OrSmQvW",tokenizers:[1,2,3,new Cn("#d~RRrs[tua#O#Pl~aOw~~dP#o#pg~lO[~~oXrs![!P!Q![#O#P![#U#V![#Y#Z![#b#c![#f#g![#h#i![#i#j!a~!aOY~~!dR!Q![!m!c!i!m#T#Z!m~!pR!Q![!y!c!i!y#T#Z!y~!|R!Q![#V!c!i#V#T#Z#V~#YR!Q![![!c!i![#T#Z![~",111,33)],topRules:{JsonText:[0,1]},tokenPrec:0}),jr=bn.define({name:"json",parser:Mr.configure({props:[yo.add({Object:nn({except:/^\s*\}/}),Array:nn({except:/^\s*\]/})}),Co.add({"Object Array":bo})]}),languageData:{closeBrackets:{brackets:["[","{",'"']},indentOnInput:/^\s*[\}\]]$/}});function Zt(){return new On(jr)}const zr="_container_1c657_1",Vr="_menu_1c657_6",Gr="_iconBar_1c657_11";var Tt={container:zr,menu:Vr,iconBar:Gr};function Br({content:e,setContent:n,selectedEnv:o}){const[a,r]=g.exports.useState({contentType:"application/json"}),{colorMode:s}=se(),l=re(),c=[Jt,Xt(o==null?void 0:o.data),Yt];s==="light"&&c.push(vn(Oo)),a.contentType==="application/json"?c.push(Zt()):a.contentType==="application/xml"?c.push(Tn()):a.contentType==="text/html"&&c.push(So());const d=g.exports.useRef(null),{setContainer:h}=it({container:d.current,onChange:m=>n(m),extensions:[c],theme:s,value:e,style:{height:"100%"}});g.exports.useEffect(()=>{d.current&&h(d.current)},[d,h]);function f(){try{const m=Hn(e,a.contentType);n(m)}catch{H("Could not format body.",l)}}return p(he,{children:[p("div",{className:Tt.menu,children:[p(Ue,{size:"xs",width:"150px",onChange:m=>r(u(i({},a),{contentType:m.target.value})),value:a.contentType,outline:"none",children:[t("option",{value:"application/json",children:"application/json"}),t("option",{value:"application/xml",children:"application/xml"}),t("option",{value:"text/html",children:"text/html"}),t("option",{value:"text/plain",children:"text/plain"}),t("option",{value:"none",children:"none"})]}),p("div",{className:Tt.iconBar,children:[t(B,{"aria-label":"beautify-content",isRound:!0,variant:"ghost",size:"xs",disabled:!["application/json","application/xml","text/html"].includes(a.contentType),onClick:f,icon:t(gn,{})}),t(B,{"aria-label":"delete-content",isRound:!0,variant:"ghost",size:"xs",disabled:e.length===0,onClick:()=>n(""),icon:t(Ne,{})})]})]}),t("div",{className:Tt.container,ref:d})]})}const Fr="_container_2hmvq_1",Kr="_select_2hmvq_7",Wr="_input_2hmvq_44",Yr="_button_2hmvq_61",Xr="_cm_2hmvq_90",Jr="_prakashurl_2hmvq_98";var ot={container:Fr,select:Kr,"select--light":"_select--light_2hmvq_24","select--dark":"_select--dark_2hmvq_32",input:Wr,"input--light":"_input--light_2hmvq_49","input--dark":"_input--dark_2hmvq_53",button:Yr,"button--light":"_button--light_2hmvq_72","button--dark":"_button--dark_2hmvq_77",cm:Xr,prakashurl:Jr};function Zr({uri:e,setUri:n,method:o,setMethod:a,isLoading:r,handleSendButtonClick:s,env:l}){const{colorMode:c}=se(),d=g.exports.useRef(null),{setContainer:h}=it({container:d.current,onChange:_=>n(_),extensions:[Kn(c),c==="light"?ar:or,Dt,Xt(l==null?void 0:l.data),Yt,Jt,Nt()],theme:c==="light"?Qt:At,value:e,className:"prakashurl",style:{color:"yellow"},placeholder:"URL",indentWithTab:!1,basicSetup:!1});g.exports.useEffect(()=>{d.current&&h(d.current)},[d,h]);function f(_){_.preventDefault(),e!==""&&s()}function m({method:_}){return t("option",{className:ne(ot,"option",[c]),value:_,children:_})}return t("div",{style:{width:"calc(100% - 40px)"},children:p("form",{className:ot.container,onSubmit:f,children:[p("select",{style:{height:"40px"},className:ne(ot,"select",[c]),value:o,onChange:_=>a(_.target.value),children:[t(m,{method:"GET"}),t(m,{method:"POST"}),t(m,{method:"PUT"}),t(m,{method:"DELETE"}),t(m,{method:"HEAD"}),t(m,{method:"OPTIONS"}),t(m,{method:"PATCH"}),t(m,{method:"CONNECT"}),t(m,{method:"TRACE"})]}),t("div",{ref:d,className:ot.cm,style:{height:"56px"}}),t("button",{style:{height:"40px"},className:ne(ot,"button",[c]),disabled:e==="",type:"submit",children:r?t(Eo,{size:"sm"}):"SEND"})]})})}const es="_box_191c0_1";var ts={box:es};function un(e,n){var l;const o=e.split("?")[1];if(!o)return(l=n==null?void 0:n.filter(c=>c.isEnabled===!1))!=null?l:[];const a=o.split("&").map(c=>{const[d,...h]=c.split("=");return{key:d,value:h.join("=")}});if(!n)return a;const r=[];let s=0;for(const[c,d]of n.entries())if(d.isEnabled===!1)r.push(d);else{const h=a[s];h?r.push(h):(console.warn("params and URI params out of sync (enabled params > URI params)"),r.push({key:"",value:""})),s++}a.length>s&&console.warn("params and URI params out of sync (URI params > enabled params)");for(let c=s;c<a.length;c++)r.push(a[c]);return r}function ns(e,n){let o=e;o.includes("?")||(o+="?");const a=o.split("?")[0];let r="";for(let s=0;s<n.length;s++)n[s].key===""&&n[s].value===""||(s!==0&&(r+="&"),r+=`${n[s].key}=${n[s].value}`);return r===""?a:`${a}?${r}`}function os({currentRequest:e,dispatchCurrentRequest:n,sendRequest:o,saveOnSend:a,handleSaveRequestClick:r,selectedEnv:s}){var A,P,k,j,D,X,b,Q,oe;const l=re(),{user:c}=g.exports.useContext(_e),d=g.exports.useMemo(()=>e.data.headers&&e.data.headers.length!==0?e.data.headers:[{key:"",value:"",isEnabled:!0}],[e.data.headers]),h=g.exports.useCallback(N=>n({type:ae.PATCH_DATA,data:{method:N}}),[n]),f=g.exports.useCallback(N=>{const pe=un(N,e.data.params);n({type:ae.PATCH_DATA,data:{uri:N,params:pe}})},[e.data.params,n]),m=g.exports.useCallback(N=>{var I;const pe=N.filter(U=>U.isEnabled!==!1),O=ns((I=e.data.uri)!=null?I:"",pe);n({type:ae.PATCH_DATA,data:{params:N,uri:O}})},[e.data.uri,n]),_=g.exports.useCallback(N=>n({type:ae.PATCH_DATA,data:{headers:N}}),[n]),C=g.exports.useCallback(N=>n({type:ae.PATCH_DATA,data:{body:N}}),[n]),y=g.exports.useCallback(N=>n({type:ae.PATCH_DATA,data:{responseScript:N}}),[n]),w=g.exports.useCallback(N=>n({type:ae.PATCH_DATA,data:{requestScript:N}}),[n]),R=g.exports.useCallback(N=>n({type:ae.PATCH_DATA,data:{description:N}}),[n]);async function E(){var N,pe;try{if(e.isLoading){n({type:ae.SET_IS_LOADING,isLoading:!1});return}n({type:ae.SET_IS_LOADING,isLoading:!0});let O=aa(e);const I=We()[O.collectionId],U=await o(O,I);n({type:ae.PATCH_DATA,data:{response:U}});const L=u(i({},e),{data:u(i({},e.data),{response:U})});((pe=(N=c==null?void 0:c.data)==null?void 0:N.settings)==null?void 0:pe.saveOnSend)&&await a(L)}catch(O){H(O.message,l,5e3)}n({type:ae.SET_IS_LOADING,isLoading:!1})}return p(Je,{className:ts.box,bg:"panelBg",h:"100%",children:[p("div",{style:{display:"flex"},children:[t(Zr,{uri:(A=e.data.uri)!=null?A:"",setUri:f,method:(P=e.data.method)!=null?P:"",setMethod:h,handleSendButtonClick:E,isLoading:e.isLoading,env:s}),t(B,{"aria-label":"save-request-button",icon:t(xn,{}),variant:"ghost",size:"sm",ml:"2",onClick:r,disabled:!e.isChanged})]}),p(qe,{isLazy:!0,colorScheme:"green",mt:"1",display:"flex",flexDirection:"column",maxHeight:"100%",h:"100%",mb:"4",children:[p(He,{children:[t(Z,{children:"Description"}),t(Z,{children:"Parameters"}),t(Z,{children:"Headers"}),t(Z,{children:"Body"}),t(Z,{children:"Request Script"}),t(Z,{children:"Response Script"})]}),p(Me,{overflowY:"auto",sx:{scrollbarGutter:"stable"},h:"100%",children:[t(ee,{children:t(Yn,{description:(j=(k=e==null?void 0:e.data)==null?void 0:k.description)!=null?j:"",setDescription:R})}),t(ee,{children:t(lt,{name:"params",kvs:(X=e.data.params)!=null?X:un((D=e.data.uri)!=null?D:""),setKvs:m,canDisableRows:!0,hasEnvSupport:"BOTH",env:s})}),t(ee,{children:t(lt,{name:"headers",kvs:d,setKvs:_,canDisableRows:!0,hasEnvSupport:"BOTH",env:s})}),t(ee,{h:"100%",children:t(Br,{content:(b=e.data.body)!=null?b:"",setContent:C,selectedEnv:s})}),t(ee,{h:"100%",children:t(gt,{content:(Q=e.data.requestScript)!=null?Q:"",setContent:w})}),t(ee,{h:"100%",children:t(gt,{content:(oe=e.data.responseScript)!=null?oe:"",setContent:y})})]})]})]})}function as({currentRequest:e,dispatchCurrentRequest:n,collections:o,dispatchCollections:a,isExtInitialized:r,extVersion:s,openExtModal:l}){const[c,d]=g.exports.useState({collectionId:-1,name:""}),{isOpen:h,onOpen:f,onClose:m}=ke(),_=g.exports.useRef(null),C=re(),{colorMode:y}=se();function w(O,I){var F;if(!I)return;const U=o.findIndex(W=>W.id===O);if(U===-1)return;const L=(F=o[U].data)==null?void 0:F.envs;if(!!L)return L[I]}Vn(R,"s",!0);async function R(){try{if(e.id===-1&&e.collectionId===-1){f();return}else await le.updateRequest(e),a({type:te.PATCH_REQUEST_DATA,id:e.id,data:i({},e.data)}),n({type:ae.SET_IS_CHANGED,isChanged:!1}),Y("The request was successfully saved.",C)}catch(O){console.error(O),H("The request could not be saved.",C)}}async function E(){try{const I=await(await le.createRequest(c.collectionId,u(i({},e==null?void 0:e.data),{name:c.name}))).json();a({type:te.PATCH_REQUEST_DATA,id:I.id,data:i({},I.data)}),n({type:ae.SET,request:I}),k(),Y("A new request was created.",C)}catch{H("The request could be not created",C)}}const A=o.find(O=>O.id===(e==null?void 0:e.collectionId)),P=A?zn(A):null;o.length>0&&c.collectionId===-1&&d(u(i({},c),{collectionId:o[0].id}));function k(){d({collectionId:-1,name:""}),m()}function j(O,I){return(U,L)=>{var T,z;if(!I)return"";const F=U.findIndex(J=>J.id===O);if(F===-1)return"";const W=(T=U[F].data)==null?void 0:T.envs;if(!W)return"";const x=W[I];return x&&(z=x.data[L])!=null?z:""}}function D(O,I,U,L){if(!!L)return a({type:te.SET_ENV_VAR,payload:{collectionId:O,envName:L,key:I,value:U}})}async function X(O,I,U){var me,v,S,q,ie;if(U&&U>=5)throw Error("Exec loop detected in request script");const L=o.find(G=>G.id===O.collectionId),F=((me=L==null?void 0:L.data)==null?void 0:me.headers)?L.data.headers.filter(G=>G.isEnabled!==!1):[],W=O.data.headers?O.data.headers.filter(G=>G.isEnabled!==!1):[],x=u(i({},O),{data:u(i({},O.data),{headers:[...F,...W]})});let T="ext";const z=w(x.collectionId,I);if(z&&(T=z.proxy),(v=L==null?void 0:L.data)==null?void 0:v.requestScript){if(T==="ext"&&sn(s.current)<3)throw Error(`Request scripts are not supported in this version of the extension. 
              Please update to the latest version or remove the request script.`);await b(x,(S=L==null?void 0:L.data)==null?void 0:S.requestScript,!0,I,U)}if(x.data.requestScript){if(T==="ext"&&sn(s.current)<3)throw Error(`Request scripts are not supported in this version of the extension. 
              Please update to the latest version or remove the request script.`);await b(x,x.data.requestScript,!1,I,U)}let J=null;switch(T){case"server":J=await pe(x,I);break;case"ext":if(!r.current)throw l(),Error("Extension not initialized");J=await oe(x,I);break;default:throw Error("Unknown proxy")}return x.data.responseScript&&Q(x,J,x.data.responseScript,!1,I),((q=L==null?void 0:L.data)==null?void 0:q.responseScript)&&Q(x,J,(ie=L==null?void 0:L.data)==null?void 0:ie.responseScript,!0,I),J}async function b(O,I,U,L,F){await qr(O,I,(z,J)=>D(O.collectionId,z,J,L),z=>j(O.collectionId,L)(o,z),async(z,J)=>{const me=o.flatMap(v=>v.requests).find(v=>v.id===z);if(!me)throw Error(`Request with id ${z} not found`);return F||(F=0),await X(me,J,F+1)},U,L)}function Q(O,I,U,L,F){Ur(O,I,U,(T,z)=>D(O.collectionId,T,z,F),T=>j(O.collectionId,F)(o,T),C,L,F)}async function oe(O,I,U){if(U&&U>=5)throw Error("Exec loop detected in request script");return new Promise((L,F)=>{var v,S,q,ie;const W=oa(O.id);function x(G){var de,xe,Ce;((de=G==null?void 0:G.data)==null?void 0:de.type)==="receive-response"&&((Ce=(xe=G==null?void 0:G.data)==null?void 0:xe.response)==null?void 0:Ce.err)?F(new Error(G.data.response.err)):G.data&&G.data.type==="receive-response"&&G.data.response.metaData.messageId===W&&(window.removeEventListener("message",x),L(rn(G.data.response)))}window.addEventListener("message",x),setTimeout(()=>{window.removeEventListener("message",x),F(new Error("Timeout wating for response from: "+O.id))},5e3);let T=i({},O);if(I){const G=o.find($=>$.id===O.collectionId);if(!G)throw Error("Collection not found for id: "+O.collectionId);const de=(S=(v=G.data)==null?void 0:v.envs)==null?void 0:S[I],xe=(q=de==null?void 0:de.data)!=null?q:{};T=$t(O,xe).result}const z=ta(T.data.uri),me={headers:St((ie=T.data.headers)!=null?ie:[]),method:T.data.method};T.data.body&&(me.body=T.data.body),window.postMessage({url:z,type:"send-request",options:me,metaData:{messageId:W,envName:I,isRequestScript:U!=null?U:0>0}},"*")})}async function N(O){if(O.id===-1)return;let I=await le.updateRequest(O);if(I.status!==200)throw new Error(`Failed to save request [Status: ${I.status}]]`);a({type:te.PATCH_REQUEST_DATA,id:O.id,data:i({},O.data)});const U=o.findIndex(F=>F.id===O.collectionId);if(U===-1)return;const L=o[U];if(I=await le.updateCollection(L),I.status!==200)throw new Error(`Failed to save collection [Status: ${I.status}]]`)}async function pe(O,I){var U,L,F;if(I){const W=o.find(J=>J.id===O.collectionId);if(!W)throw Error("Collection not found for id: "+O.collectionId);const x=(L=(U=W.data)==null?void 0:U.envs)==null?void 0:L[I],T=(F=x==null?void 0:x.data)!=null?F:{};O=$t(O,T).result}return le.invoke(O,I!=null?I:"NO_ENV").then(W=>{if(W.status!==200)throw new Error(`Server error. Status: ${W.status}`);return W.json()}).then(W=>{if(W.error)throw new Error(W.error);return rn(W)})}return p(he,{children:[e&&t(os,{currentRequest:e,dispatchCurrentRequest:n,handleSaveRequestClick:R,sendRequest:X,saveOnSend:N,selectedEnv:P}),p(Te,{isOpen:h,onClose:k,initialRef:_,heading:"Save a new request",onClick:E,isButtonDisabled:c.name===""||c.collectionId===-1,buttonText:"Save",buttonColor:"green",children:[t(we,{placeholder:"Name",w:"100%",borderRadius:20,colorScheme:"green",backgroundColor:y==="light"?"white":void 0,value:c.name,onChange:O=>d(u(i({},c),{name:O.target.value})),ref:_,mb:"4"}),t(Ue,{borderRadius:20,value:c.collectionId,onChange:O=>d(u(i({},c),{collectionId:Number(O.target.value)})),children:o.map(O=>t("option",{value:O.id,children:O.data.name},`collection-dropdown-${O.id}`))})]})]})}const rs="_container_1v7l3_1",ss="_tabList_1v7l3_6",is="_statusText_1v7l3_20";var je={container:rs,tabList:ss,"tabList--light":"_tabList--light_1v7l3_12","tabList--dark":"_tabList--dark_1v7l3_16",statusText:is};function cs(e){let n=[];return e.includes("application/json")?n.push(Zt()):(e.includes("application/xml")||e.includes("text/html"))&&n.push(Tn()),n}const ls=e=>{var n,o;return(o=(n=e.find(a=>a.key.toLowerCase()==="content-type"))==null?void 0:n.value)!=null?o:""};function ds({response:e}){var c,d;const{colorMode:n}=se(),o=re(),{onCopy:a}=mt((c=e==null?void 0:e.body)!=null?c:"");function r(){a(),Y("Copied to clipboard",o)}const s=ls((d=e==null?void 0:e.headers)!=null?d:[]),l=cs(s);return t(Je,{className:je.container,bg:"panelBg",h:"100%",children:e?p(qe,{isLazy:!0,colorScheme:"green",mt:"1",display:"flex",flexDirection:"column",maxHeight:"100%",children:[p("div",{className:ne(je,"tabList",[n]),children:[p(He,{borderWidth:0,children:[t(Z,{children:"Body"}),t(Z,{children:"Headers"})]}),p("div",{children:["Status",t("span",{className:je.statusText,children:e.status}),"Time",t("span",{className:je.statusText,children:e.time}),"Size",t("span",{className:je.statusText,children:e.size}),e.date&&p(he,{children:["Date",t("span",{className:je.statusText,children:e.date})]}),t(B,{"aria-label":"save-request-button",icon:t(ct,{}),variant:"ghost",size:"sm",ml:"2",disabled:!e||!e.body,onClick:r})]})]}),p(Me,{overflowY:"auto",sx:{scrollbarGutter:"stable"},children:[t(ee,{children:t(Ft,{height:"100%",extensions:l,theme:n,value:e.body,editable:!1})}),t(ee,{children:t(lt,{name:"response-headers",kvs:e.headers,readOnly:!0,hasEnvSupport:"NONE"})})]})]}):t(fn,{h:"100%",children:t(Re,{children:"Push send to get a response..."})})})}var us={};const $e={COLLECTION:"collection",REQUEST:"request"};function hs(e){return _o(e)}const ps="_header_qmcah_1",fs="_wrapper_qmcah_46",ms="_icon_qmcah_55",gs="_name_qmcah_68",vs="_actionIcon_qmcah_77",ws="_requests_qmcah_83",ys="_hovered_qmcah_91";var Le={header:ps,"header--light":"_header--light_qmcah_22","header--dark":"_header--dark_qmcah_30","header--selected":"_header--selected_qmcah_38",wrapper:fs,icon:ms,"icon--open":"_icon--open_qmcah_60",name:gs,actionIcon:vs,requests:ws,"requests--open":"_requests--open_qmcah_87",hovered:ys};const Cs="_request_14kia_1",bs="_requestName_14kia_40",Os="_requestMethod_14kia_48",Ss="_actionIcon_14kia_59";var ut={request:Cs,"request--light":"_request--light_14kia_14","request--selected":"_request--selected_14kia_18","request--dark":"_request--dark_14kia_22",requestName:bs,requestMethod:Os,actionIcon:Ss};function Es(e,n){e.key==="Enter"&&n(e)}const _s=({request:e,selected:n,renameRequest:o,selectRequest:a,deleteRequest:r,duplicateRequest:s})=>{const[l,c]=g.exports.useState({name:e.name,currentModal:""}),d=g.exports.useRef(null),{colorMode:h}=se(),{isOpen:f,onOpen:m,onClose:_}=ke(),C=re(),{onCopy:y}=mt(`${window.location.origin}/#/${e.collectionId}/${e.id}`),{onCopy:w}=mt(`${e.id}`),R=n?["selected"]:[];function E(){c(u(i({},l),{name:e.name})),_()}const A=t(Te,{isOpen:f,onClose:E,initialRef:d,heading:`Rename ${e.name}`,onClick:()=>{o(e.id,l.name),E()},isButtonDisabled:l.name===e.name||l.name==="",buttonText:"Rename",buttonColor:"green",children:t(we,{placeholder:"Name",w:"100%",borderRadius:20,colorScheme:"green",backgroundColor:h==="light"?"white":void 0,value:l.name,onChange:X=>c(u(i({},l),{name:X.target.value})),ref:d})}),P=p(Te,{isOpen:f,initialRef:void 0,onClose:E,heading:`Delete "${e.name}"`,onClick:()=>r(e.id),buttonText:"Delete",buttonColor:"red",isButtonDisabled:!1,children:["Are you sure you want to delete this request?",t("br",{}),"The request cannot be recovered!"]}),k=t(Te,{isOpen:f,initialRef:void 0,onClose:E,heading:`Duplicate "${e.name}"`,onClick:()=>{s(e.id,l.name),E()},buttonText:"Duplicate",buttonColor:"green",isButtonDisabled:!1,children:t(we,{placeholder:"Name",w:"100%",borderRadius:20,colorScheme:"green",backgroundColor:h==="light"?"white":void 0,value:l.name,onChange:X=>c(u(i({},l),{name:X.target.value})),ref:d})});let j;l.currentModal==="rename"?j=A:l.currentModal==="delete"?j=P:l.currentModal==="duplicate"&&(j=k);let D=e.method;return D==="DELETE"?D="DEL":D==="OPTIONS"?D="OPT":D==="PATCH"?D="PTCH":D==="TRACE"?D="TRCE":D==="CONNECT"&&(D="CON"),p("div",{className:ne(ut,"request",[...R,h]),onClick:()=>a.current(e.id),onKeyDown:X=>Es(X,()=>a.current(e.id)),role:"button",tabIndex:0,children:[t("span",{className:ne(ut,"requestMethod",[h]),style:ea(e.method),children:D}),t("span",{className:ne(ut,"requestName",[h]),children:e.name}),t("span",{className:ut.actionIcon,children:t(kn,{children:({isOpen:X})=>p(he,{children:[t(In,{as:B,"aria-label":"Options",icon:t(Pn,{}),variant:"ghost",onClick:b=>b.stopPropagation()}),p(Rn,{zIndex:50,style:{display:X?"":"none"},children:[t(Pe,{icon:t(Kt,{}),onClick:b=>{b.stopPropagation(),c(u(i({},l),{currentModal:"rename",name:e.name})),m()},children:"Rename"}),t(Pe,{icon:t(ct,{}),onClick:b=>{b.stopPropagation(),c(u(i({},l),{currentModal:"duplicate",name:`${e.name} (copy)`})),m()},children:"Duplicate"}),t(Pe,{icon:t(Nn,{}),onClick:b=>{b.stopPropagation(),y(),Y("Link copied to clipboard.",C)},children:"Copy Link"}),t(Pe,{icon:t(ct,{}),onClick:b=>{b.stopPropagation(),w(),Y("Request ID copied to clipboard.",C)},children:"Copy ID"}),t(Pe,{icon:t(Ne,{}),onClick:b=>{b.stopPropagation(),c(u(i({},l),{currentModal:"delete"})),m()},children:"Delete"})]})]})})}),j]})};function xs({request:e,index:n,selected:o,moveRequest:a,selectRequest:r,renameRequest:s,deleteRequest:l,duplicateRequest:c,dispatchCollections:d}){const h=e.id,f=g.exports.useRef(null),[{handlerId:m,hoveredDownwards:_,hoveredUpwards:C},y]=Wt({accept:$e.REQUEST,collect(P){if(!f.current||!P||!P.getItem()||P.getItem().id===h||P.getItem().collectionId!==e.collectionId)return{handlerId:null,hoveredDownwards:!1,hoveredUpwards:!1};const k=P.getItem().index,j=P.isOver()&&k>n,D=P.isOver()&&k<n;return{handlerId:P.getHandlerId(),hoveredDownwards:D,hoveredUpwards:j}},drop(P){P.index!==n&&a(P.id,n)}}),[{isDragging:w},R]=Dn({type:$e.REQUEST,item:()=>({id:h,index:n,type:$e.REQUEST,collectionId:e.collectionId,requestId:e.id}),collect:P=>({isDragging:P.isDragging()})}),E=w?.5:1;let A="none";return _&&(A="0 2px 0 var(--chakra-colors-green-500)"),C&&(A="0 -2px 0 var(--chakra-colors-green-500)"),R(y(f)),t("div",{ref:f,style:{boxShadow:A,opacity:E,boxSizing:"border-box"},children:t(_s,{request:e,"data-handler-id":m,selected:o,selectRequest:r,dispatchCollections:d,renameRequest:s,deleteRequest:l,duplicateRequest:c})})}var Ts=dt.memo(xs,(e,n)=>e.selected===n.selected&&e.request.id===n.request.id&&e.request.name===n.request.name&&e.request.collectionId===n.request.collectionId&&e.request.method===n.request.method&&e.index===n.index&&e.deleteRequest===n.deleteRequest&&e.renameRequest===n.renameRequest&&e.selectRequest===n.selectRequest&&e.moveRequest===n.moveRequest);function ks({collection:e,currentRequstId:n,currentCollectionId:o,selectCollection:a,selectRequest:r,renameRequest:s,deleteRequest:l,duplicateRequest:c,duplicateCollection:d,dispatchCollections:h}){var W;const[f,m]=g.exports.useState({name:e.name,newRequestName:"",currentModal:"",importData:""}),_=g.exports.useRef(null),C=g.exports.useRef(null),{colorMode:y}=se(),w=o===e.id?["selected"]:[],R=e.open?["open"]:[],{isOpen:E,onOpen:A,onClose:P}=ke(),k=re(),{onCopy:j}=mt(`${window.location.origin}/#/${e.id}`);function D(x,T){x.key==="Enter"&&T(x)}async function X(){try{let x={};if(f.importData){const J=hs(f.importData);x={name:f.newRequestName,method:J.method,uri:J.url,headers:Object.entries(J.header).map(([me,v])=>({key:me,value:v})),body:J.body}}else x={name:f.newRequestName,method:"GET"};const z=await(await le.createRequest(e.id,x)).json();h({type:te.ADD_REQUEST,request:z}),r.current(z.id),oe(),Y("A new request was created.",k)}catch(x){console.error(x),H("The request could be not created",k)}}function b(){h({type:te.TOGGLE_OPEN_COLLECTION,id:e.id})}async function Q(){try{if((await le.deleteCollection(e.id)).status!==200)throw new Error;h({type:te.DELETE_COLLECTION,id:e.id}),oe(),Y("Collection was deleted.",k)}catch{H("Could not delete collection.",k)}}function oe(){m(u(i({},f),{newRequestName:"",importData:""})),P()}const N=E?(x=>{switch(x){case"newRequest":return t(Te,{isOpen:E,onClose:oe,initialRef:_,heading:"Create a new request",onClick:X,isButtonDisabled:f.newRequestName==="",buttonText:"Create",buttonColor:"green",children:p(qe,{isLazy:!0,colorScheme:"green",display:"flex",flexDirection:"column",maxHeight:"100%",h:"100%",children:[p(He,{children:[t(Z,{children:"Basic"}),t(Z,{children:"Import"})]}),p(Me,{overflowY:"auto",sx:{scrollbarGutter:"stable"},h:"100%",children:[t(ee,{children:t(we,{placeholder:"Name",w:"100%",borderRadius:20,backgroundColor:y==="light"?"white":void 0,colorScheme:"green",value:f.newRequestName,onChange:T=>m(u(i({},f),{newRequestName:T.target.value})),ref:_})}),p(ee,{children:[t(Ue,{size:"xs",value:"curl",marginBottom:4,children:t("option",{value:"curl",children:"cURL"})}),t(we,{placeholder:"Name",w:"100%",borderRadius:20,colorScheme:"green",value:f.newRequestName,marginBottom:4,onChange:T=>m(u(i({},f),{newRequestName:T.target.value}))}),t(xo,{placeholder:"cURL",value:f.importData,onChange:T=>m(u(i({},f),{importData:T.target.value})),height:"150px",resize:"none"})]})]})]})});case"duplicate":return t(Te,{isOpen:E,onClose:oe,heading:`Duplicate "${e.name}"`,onClick:()=>{d(e.id,f.name),oe()},buttonText:"Duplicate",buttonColor:"green",isButtonDisabled:!1,children:t(we,{placeholder:"Name",w:"100%",borderRadius:20,colorScheme:"green",backgroundColor:y==="light"?"white":void 0,value:f.name,onChange:T=>m(u(i({},f),{name:T.target.value})),ref:_})});case"delete":return p(Te,{isOpen:E,onClose:oe,heading:`Delete "${e.name}"`,onClick:Q,buttonText:"Delete",buttonColor:"red",isButtonDisabled:!1,children:["Are you sure you want to delete this collection?",t("br",{}),"The collection cannot be recovered!"]})}})(f.currentModal):null,pe=g.exports.useCallback(async(x,T,z)=>{try{if(!z&&T!==void 0){if(h({type:te.MOVE_REQUEST,id:x,newRank:T}),(await le.moveRequest(x,T)).status!==200)throw new Error}else{if(!z)throw new Error("newCollectionId is undefined");if(h({type:te.CHANGE_REQUEST_COLLECTION,id:x,newCollectionId:z}),(await le.changeRequestCollection(x,z)).status!==200)throw new Error;Y("Request was moved.",k)}}catch(J){console.error(J),H("Could not move request.",k)}},[h,k]),[{handlerId:O,hovered:I},U]=Wt({accept:[$e.REQUEST],collect(x){let T=!1;const z=x.getItem();return z&&z.type===$e.REQUEST&&(T=x.isOver()&&z.collectionId!==e.id),{handlerId:x.getHandlerId(),hovered:T}},drop(x){!C.current||x.type!==$e.REQUEST||x.collectionId!==e.id&&pe(x.id,void 0,e.id)}}),L=I?Le.hovered:"";U(C);const F=g.exports.useCallback((x,T)=>t(Ts,{request:x,index:T,moveRequest:pe,selected:n===x.id,selectRequest:r,renameRequest:s,deleteRequest:l,duplicateRequest:c,dispatchCollections:h},x.id),[n,l,h,pe,s,c,r]);return p("div",{className:Le.root,children:[p("div",{ref:C,"data-handler-id":O,className:ne(Le,"header",[...w,y])+" "+L,children:[t(To,{className:ne(Le,"icon",[...R,y]),onClick:b}),p("div",{className:Le.wrapper,onClick:()=>a.current(e.id),onKeyDown:x=>D(x,b),role:"button",tabIndex:0,children:[t("span",{className:Le.name,children:e.name}),t("span",{className:Le.actionIcon,children:t(kn,{children:({isOpen:x})=>p(he,{children:[t(In,{as:B,"aria-label":"Options",icon:t(Pn,{}),variant:"ghost",onClick:T=>T.stopPropagation()}),p(Rn,{zIndex:50,style:{display:x?"":"none"},children:[t(Pe,{icon:t(Bt,{}),onClick:T=>{T.stopPropagation(),m(u(i({},f),{currentModal:"newRequest"})),A()},children:"New Request"}),t(Pe,{icon:t(Nn,{}),onClick:T=>{T.stopPropagation(),j(),Y("Link copied to clipboard.",k)},children:"Copy Link"}),t(Pe,{icon:t(ct,{}),onClick:T=>{T.stopPropagation(),m(u(i({},f),{currentModal:"duplicate",name:`${e.name} (copy)`})),A()},children:"Duplicate"}),t(Pe,{icon:t(Ne,{}),onClick:T=>{T.stopPropagation(),m(u(i({},f),{currentModal:"delete"})),A()},children:"Delete"})]})]})})})]})]}),e.open&&t("div",{className:ne(Le,"requests",[...R,y]),children:(W=e.requests)==null?void 0:W.map((x,T)=>F(x,T))}),N]})}function Is({collection:e,moveCollection:n,index:o,currentCollectionId:a,currentRequstId:r,selectCollection:s,selectRequest:l,renameRequest:c,deleteRequest:d,duplicateRequest:h,duplicateCollection:f,dispatchCollections:m}){const _=e.id,C=g.exports.useRef(null),[{handlerId:y,hoveredDownwards:w,hoveredUpwards:R},E]=Wt({accept:$e.COLLECTION,collect(D){if(!C.current||!D||!D.getItem()||D.getItem().id===_)return{handlerId:null,hoveredDownwards:!1,hoveredUpwards:!1};const X=D.getItem().index,b=D.isOver()&&X>o,Q=D.isOver()&&X<o;return{handlerId:D.getHandlerId(),hoveredDownwards:Q,hoveredUpwards:b}},drop(D){D.index!==o&&n(D.index,o)}}),[{isDragging:A},P]=Dn({type:$e.COLLECTION,item:()=>({id:_,index:o}),collect:D=>({isDragging:D.isDragging()})}),k=A?.5:1;let j="none";return w&&(j="0 2px 0 var(--chakra-colors-green-500)"),R&&(j="0 -2px 0 var(--chakra-colors-green-500)"),P(E(C)),t("div",{ref:C,style:{opacity:k,boxShadow:j},"data-handler-id":y,children:t(ks,{collection:e,currentRequstId:r,currentCollectionId:a,selectCollection:s,selectRequest:l,renameRequest:c,deleteRequest:d,duplicateRequest:h,duplicateCollection:f,dispatchCollections:m})})}function Ps({collections:e,currentCollectionId:n,currentRequstId:o,selectCollection:a,selectRequest:r,renameRequest:s,deleteRequest:l,duplicateRequest:c,duplicateCollection:d,dispatchCollections:h}){const f=re(),m=async(C,y)=>{const w=e[C];h({type:te.MOVE_COLLECTION,id:w.id,newRank:y});try{if((await le.moveCollection(w.id,y)).status!==200)throw new Error;Y("Collection was moved.",f)}catch{H("Could not move collection.",f)}},_=(C,y)=>t(Is,{collection:C,index:y,moveCollection:m,currentCollectionId:n,currentRequstId:o,selectCollection:a,selectRequest:r,renameRequest:s,deleteRequest:l,duplicateRequest:c,duplicateCollection:d,dispatchCollections:h},C.id);return t("div",{className:us.collections,children:t(ko,{backend:Io,children:e.map((C,y)=>_(C,y))})})}var Rs=dt.memo(Ps);const Ns="_searchContainer_1fjsa_1",Ds="_search_1fjsa_1",Ls="_searchWithClear_1fjsa_47",$s="_clearSearch_1fjsa_52",As="_box_1fjsa_62",Qs="_fileInput_1fjsa_69";var ze={searchContainer:Ns,"searchContainer--light":"_searchContainer--light_1fjsa_12","searchContainer--dark":"_searchContainer--dark_1fjsa_17",search:Ds,"search--light":"_search--light_1fjsa_31","search--dark":"_search--dark_1fjsa_39",searchWithClear:Ls,clearSearch:$s,box:As,fileInput:Qs,"fileInput--light":"_fileInput--light_1fjsa_89","fileInput--dark":"_fileInput--dark_1fjsa_93"};function Us({collections:e,dispatchCollections:n,currentCollectionId:o,currentRequstId:a,selectCollection:r,selectRequest:s,renameRequest:l,deleteRequest:c,duplicateCollection:d,duplicateRequest:h}){var D,X;const f=re(),{user:m}=g.exports.useContext(_e),{isOpen:_,onOpen:C,onClose:y}=ke(),[w,R]=g.exports.useState({clickedCollectionId:-1,name:"",groups:(X=(D=m==null?void 0:m.data)==null?void 0:D.groups)!=null?X:[],searchTerm:"",uploadFile:void 0,basePath:"",selectedImport:"openapi"}),{colorMode:E}=se(),A=g.exports.useRef(null),P=dt.useMemo(()=>e.filter(b=>b.name.toLowerCase().includes(w.searchTerm.toLowerCase())),[e,w.searchTerm]);function k(){var b,Q;R(u(i({},w),{name:"",groups:(Q=(b=m==null?void 0:m.data)==null?void 0:b.groups)!=null?Q:[],uploadFile:void 0,basePath:"",selectedImport:"openapi"})),y()}async function j(){try{let b;if(w.uploadFile){const oe=new FormData;oe.append("File",w.uploadFile,"file"),w.selectedImport==="openapi"?b=await le.importOpenApi(w.basePath,w.groups,oe):b=await le.importPostman(w.groups,oe)}else b=await le.createCollection(w.name,w.groups);if(b.status!==200)throw new Error;const Q=await b.json();n({type:te.ADD_COLLECTION,collection:Q}),Y("A new collection was created and saved",f),k()}catch(b){console.log(b),H("The collection could be not created",f)}}return p(Je,{className:ze.box,bg:"panelBg",h:"100%",w:"100%",children:[t(qt,{children:p("div",{className:ne(ze,"searchContainer",[E]),children:[p("div",{className:ze.searchWithClear,children:[t("input",{className:ne(ze,"search",[E]),placeholder:"Search...",value:w.searchTerm,onChange:b=>R(u(i({},w),{searchTerm:b.target.value}))}),t("button",{className:ne(ze,"clearSearch",[E]),onClick:()=>R(u(i({},w),{searchTerm:""})),children:w.searchTerm!==""?p("svg",{width:"12px",height:"12px",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[t("line",{x1:"3",y1:"3",x2:"21",y2:"21",stroke:E==="light"?"black":"white",strokeWidth:"2"}),t("line",{x1:"21",y1:"3",x2:"3",y2:"21",stroke:E==="light"?"black":"white",strokeWidth:"2"})]}):null})]}),t(Po,{}),t(B,{"aria-label":"add-collection-button",icon:t(Bt,{}),variant:"ghost",onClick:C}),t(B,{"aria-label":"collapse-all-collection",icon:t(Ln,{}),variant:"ghost",onClick:()=>n({type:te.CLOSE_ALL})})]})}),t(Rs,{collections:P,currentCollectionId:o,currentRequstId:a,selectCollection:r,selectRequest:s,renameRequest:l,deleteRequest:c,duplicateRequest:h,duplicateCollection:d,dispatchCollections:n}),t(Te,{isOpen:_,onClose:k,initialRef:A,heading:"Create a new collection",onClick:j,isButtonDisabled:w.name==="",buttonText:"Create",buttonColor:"green",children:p(qe,{isLazy:!0,colorScheme:"green",display:"flex",flexDirection:"column",maxHeight:"100%",h:"100%",children:[p(He,{children:[t(Z,{children:"Basic"}),t(Z,{children:"Import"})]}),p(Me,{overflowY:"auto",sx:{scrollbarGutter:"stable"},h:"100%",children:[p(ee,{children:[t(we,{placeholder:"Name",w:"100%",my:"4",borderRadius:20,colorScheme:"green",backgroundColor:E==="light"?"white":void 0,value:w.name,onChange:b=>R(u(i({},w),{name:b.target.value})),ref:A}),t(Xe,{groups:w.groups,setGroups:b=>R(u(i({},w),{groups:b})),isRounded:!0})]}),p(ee,{children:[p(Ue,{size:"xs",onChange:b=>R(u(i({},w),{selectedImport:b.target.value})),value:w.selectedImport,children:[t("option",{value:"openapi",children:"OpenAPI"}),t("option",{value:"postman",children:"Postman"})]}),t("input",{className:ne(ze,"fileInput",[E]),type:"file",accept:".yaml,.json",onChange:b=>{var oe;const Q=b.target.files?b.target.files[0]:void 0;R(u(i({},w),{uploadFile:Q,name:(oe=Q==null?void 0:Q.name)!=null?oe:"filename"}))}}),w.selectedImport==="openapi"?t(we,{placeholder:"Base Path",mb:"4",w:"100%",borderRadius:20,colorScheme:"green",backgroundColor:E==="light"?"white":void 0,value:w.basePath,onChange:b=>R(u(i({},w),{basePath:b.target.value}))}):null,t(Xe,{groups:w.groups,setGroups:b=>R(u(i({},w),{groups:b})),isRounded:!0})]})]})]})})]})}const qs="_parent_6wgvg_1",Hs="_allotment_6wgvg_5",Ms="_sidebar_6wgvg_9",js="_main_6wgvg_13",zs="_requestPanel_6wgvg_17",Vs="_responsePanel_6wgvg_21";var Ve={parent:qs,allotment:Hs,sidebar:Ms,main:js,requestPanel:zs,responsePanel:Vs};function hn(){var ie,G,de,xe,Ce;const[e,n]=g.exports.useReducer(Ha,jn),[o,a]=g.exports.useReducer(Qr,Ut),[r,s]=g.exports.useReducer(Ga,void 0),[l,c]=g.exports.useState(void 0),[d,h]=g.exports.useState(void 0),f=Ro(),m=No(),_=g.exports.useRef(!1),C=g.exports.useRef(void 0),y=$=>{C.current=$},{isOpen:w,onOpen:R,onClose:E}=ke(),{isOpen:A,onOpen:P,onClose:k}=ke(),{isOpen:j,onOpen:D,onClose:X}=ke(),{user:b}=g.exports.useContext(_e),[Q,oe]=g.exports.useState(0);g.exports.useState(0);const N=re(),pe=g.exports.useMemo(()=>e.map($=>{var V,K,ue;return{id:$.id,name:(V=$.data.name)!=null?V:"",open:$.open,selected:!1,groups:$.data.groups,requests:(ue=(K=$.requests)==null?void 0:K.map(ge=>{var be,et;return{id:ge.id,collectionId:ge.collectionId,name:(be=ge.data.name)!=null?be:"",method:(et=ge.data.method)!=null?et:""}}))!=null?ue:[]}}),[e]);g.exports.useEffect(()=>{if(_.current)return;const $=setInterval(()=>{console.log("Checking extension"),_.current?clearInterval($):window.postMessage({type:"ping"},"*")},6e4);(async()=>{try{const ue=await(await fetch(M+"api/collection")).json(),ge=na(m);ue.forEach(be=>{ge.collectionId===be.id&&(be.open=!0,ge.requestId&&be.requests?be.requests.forEach(et=>{ge.requestId===et.id&&a({type:ae.SET,request:et})}):(s({type:ye.SET,collection:be}),a({type:ae.UNSET})))}),n({type:te.SET,collections:ue})}catch{H("Could not retrieve collections",N)}})()},[]);const O=$=>{$.data.type==="pong"&&(console.log("Extension connected"),_.current=!0,y($.data.version),E())},I=g.exports.useCallback($=>{const V=e.find(K=>K.id===$);if(!V)throw new Error("Collection doesn't exist");f(`/${$}`),a({type:ae.UNSET}),s({type:ye.SET,collection:V})},[e,f]),U=g.exports.useCallback($=>{const V=e.map(K=>K.requests).flat().find(K=>K.id===$);if(!V)throw new Error("Request doesn't exist");f(`/${V.collectionId}/${V.id}`),a({type:ae.SET,request:V}),s({type:ye.UNSET})},[e,f]),L=g.exports.useCallback($=>le.updateRequest($).then(V=>{if(V.status!==200)throw new Error;Y("Request was saved.",N)}).catch(V=>{console.error(V),H("Could not save request",N)}),[N]),F=g.exports.useCallback($=>le.updateCollection($).then(V=>{if(V.status!==200)throw new Error;Y("Request was saved.",N)}).catch(V=>{console.error(V),H("Could not save request",N)}),[N]),W=g.exports.useCallback(async $=>{var V,K;try{if((o==null?void 0:o.id)===$)return;((K=(V=b==null?void 0:b.data)==null?void 0:V.settings)==null?void 0:K.saveOnClose)?((o==null?void 0:o.isChanged)?(L(o),n({type:te.PATCH_REQUEST_DATA,id:o.id,data:i({},o.data)})):(r==null?void 0:r.isChanged)&&(F(r),n({type:te.PATCH_COLLECTION_DATA,id:r.id,data:i({},r.data)})),U($)):(o==null?void 0:o.isChanged)&&(o==null?void 0:o.id)!==-1?(c($),P()):(r==null?void 0:r.isChanged)?(c($),D()):U($)}catch(ue){console.error(ue),H("Could not select request",N)}},[o,(G=(ie=b==null?void 0:b.data)==null?void 0:ie.settings)==null?void 0:G.saveOnClose,r,U,L,F,P,D,N]),x=g.exports.useRef(W);g.exports.useEffect(()=>{x.current=W},[W]);const T=g.exports.useCallback(async $=>{var V,K;try{if((r==null?void 0:r.id)===$)return;((K=(V=b==null?void 0:b.data)==null?void 0:V.settings)==null?void 0:K.saveOnClose)?((o==null?void 0:o.isChanged)?(L(o),n({type:te.PATCH_REQUEST_DATA,id:o.id,data:i({},o.data)})):(r==null?void 0:r.isChanged)&&(F(r),n({type:te.PATCH_COLLECTION_DATA,id:r.id,data:i({},r.data)})),I($)):(o==null?void 0:o.isChanged)&&(o==null?void 0:o.id)!==-1?(h($),P()):(r==null?void 0:r.isChanged)?(h($),D()):I($)}catch(ue){console.error(ue),H("Could not select collection",N)}},[r,o,I,D,P,N,F,L,(xe=(de=b==null?void 0:b.data)==null?void 0:de.settings)==null?void 0:xe.saveOnClose]),z=g.exports.useRef(T);g.exports.useEffect(()=>{z.current=T},[T]);const J=g.exports.useCallback(async($,V)=>{try{const K=e.map(ge=>ge.requests).flat().find(ge=>ge.id===$);if(!K)return;const ue=u(i({},K),{data:u(i({},K.data),{name:V})});await le.updateRequest(ue),n({type:te.PATCH_REQUEST_DATA,id:$,data:{name:V}}),(o==null?void 0:o.id)===$&&a({type:ae.PATCH_DATA,data:{name:V}}),Y("Request was renamed.",N)}catch(K){console.error(K),H("Could not rename request",N)}},[e,o==null?void 0:o.id,N]),me=g.exports.useCallback(async $=>{try{await le.deleteRequest($),n({type:te.DELETE_REQUEST,id:$}),(o==null?void 0:o.id)===$&&a({type:ae.SET,request:Ut}),Y("Request was deleted.",N)}catch(V){console.error(V),H("Could not delete request",N)}},[o==null?void 0:o.id,N]),v=g.exports.useCallback(async($,V)=>{try{const K=e.map(be=>be.requests).flat().find(be=>be.id===$);if(!K)return;const ue=await le.createRequest(K.collectionId,u(i({},K.data),{name:V}));if(ue.status!==200)throw new Error;const ge=await ue.json();n({type:te.ADD_REQUEST,request:ge}),x.current(ge.id),Y("Request was duplicated.",N)}catch(K){console.error(K),H("Could not duplicate request",N)}},[e,N]),S=g.exports.useCallback(async($,V)=>{try{const K=await le.duplicateCollection($,V);if(K.status!==200)throw new Error;const ue=await K.json();n({type:te.ADD_COLLECTION,collection:ue}),z.current(ue.id),Y("Collection was duplicated.",N)}catch(K){console.error(K),H("Could not duplicate collection",N)}},[N]);Do("message",O);let q=t("div",{children:"Select a Request or Collection"});return r&&(q=t(Nr,{currentCollection:r,dispatchCurrentCollection:s,dispatchCollections:n,tabIndex:Q,setTabIndex:oe})),o&&(q=p(on,{vertical:!0,defaultSizes:[200,100],snap:!0,children:[t("div",{className:Ve.requestPanel,children:t(as,{currentRequest:o,dispatchCurrentRequest:a,collections:e,dispatchCollections:n,isExtInitialized:_,extVersion:C,openExtModal:R})}),t("div",{className:Ve.responsePanel,children:t(ds,{response:(Ce=o==null?void 0:o.data)==null?void 0:Ce.response})})]})),p("div",{className:Ve.parent,children:[t("div",{className:Ve.allotment,children:p(on,{defaultSizes:[50,200],snap:!0,children:[t("div",{className:Ve.sidebar,children:t(Us,{collections:pe,currentCollectionId:r==null?void 0:r.id,currentRequstId:o==null?void 0:o.id,selectCollection:z,selectRequest:x,renameRequest:J,deleteRequest:me,duplicateRequest:v,duplicateCollection:S,dispatchCollections:n})}),t("div",{className:Ve.main,children:q})]})}),p(Ht,{isOpen:w,onClose:()=>{},children:[t(Ct,{}),p(Mt,{children:[t(jt,{children:"Failed to connect to extension"}),p(Vt,{children:["The extension could not be connected or needs to be updated. Please install"," ",t("b",{children:t("a",{style:{textDecoration:"underline"},target:"_blank",href:"https://chrome.google.com/webstore/detail/yaade-extension/mddoackclclnbkmofficmmepfnadolfa",rel:"noreferrer",children:"the extension"})})," ","and copy the URL of this window into the host field of the extension. Then click retry.",t("br",{}),'Alternatively change the proxy of your current environment to "Server".']}),p(mn,{children:[t(Ee,{variant:"ghost",mr:"2",onClick:E,children:"Dismiss"}),t(Ee,{colorScheme:"green",onClick:()=>window.postMessage({type:"ping"},"*"),children:"Retry"})]})]})]}),p(Te,{isOpen:A,initialRef:void 0,onClose:()=>{c(void 0),h(void 0),k()},heading:"Request not saved",onClick:()=>{!o||(L(o),n({type:te.PATCH_REQUEST_DATA,id:o.id,data:i({},o.data)}),l?(U(l),c(void 0)):d&&(I(d),h(void 0)),k())},buttonText:"Save",buttonColor:"green",isButtonDisabled:!1,secondaryButtonText:"Discard",onSecondaryButtonClick:()=>{l?(U(l),c(void 0)):d&&(I(d),h(void 0)),k()},children:["The request has unsaved changes which will be lost if you choose to change the tab now.",t("br",{}),"Do you want to save the changes now?"]}),p(Te,{isOpen:j,initialRef:void 0,onClose:()=>{c(void 0),h(void 0),X()},heading:"Collection not saved",onClick:()=>{!r||(F(r),n({type:te.PATCH_COLLECTION_DATA,id:r.id,data:i({},r.data)}),l?(U(l),c(void 0)):d&&(I(d),h(void 0)),X())},buttonText:"Save",buttonColor:"green",isButtonDisabled:!1,secondaryButtonText:"Discard",onSecondaryButtonClick:()=>{l?(U(l),c(void 0)):d&&(I(d),h(void 0)),X()},children:["The collection has unsaved changes which will be lost if you choose to change the tab now.",t("br",{}),"Do you want to save the changes now?"]})]})}function Gs(){return t(he,{children:t("h1",{children:"Hisotry page here !"})})}const Bs="_settingsTabContainer_1apqq_1";var Fs={settingsTabContainer:Bs};const Ze=({name:e,children:n})=>p("div",{className:Fs.settingsTabContainer,children:[p("div",{style:{display:"flex"},children:[t(fe,{mb:"4",children:e}),t(zt,{ml:"auto",size:"md"})]}),t(st,{mb:"4"}),n]}),Ks="_input_1goeb_1";var kt={input:Ks,"input--light":"_input--light_1goeb_9","input--dark":"_input--dark_1goeb_16"};const It={currentPassword:"",newPassword:"",repeatPassword:""},Ws=()=>{var d,h,f;const[e,n]=g.exports.useState(It),{colorMode:o}=se(),{user:a,setUser:r}=g.exports.useContext(_e),s=re();async function l(){try{if((await fetch(M+"api/user",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({currentPassword:e.currentPassword,newPassword:e.newPassword})})).status!==200)throw new Error;n(It),r(void 0),Y("Password changed.",s)}catch{n(It),H("Password could not be changed.",s)}}async function c(){try{if((await fetch(M+"api/logout",{method:"POST"})).status!==200)throw new Error;r(void 0)}catch{H("Failed to logout",s)}}return p(Ze,{name:"Account",children:[t(fe,{as:"h4",size:"md",mb:"4",children:"User"}),p($n,{direction:"row",alignItems:"center",mb:"4",children:[t("p",{children:"Logged in as"}),t("span",{style:{fontWeight:700},children:a==null?void 0:a.username}),t(Ee,{colorScheme:"red",variant:"outline",size:"sm",borderRadius:20,onClick:c,children:"Logout"})]}),t(fe,{as:"h4",size:"md",mb:"4",children:"Groups"}),t(_n,{mb:"4",children:(h=(d=a==null?void 0:a.data)==null?void 0:d.groups)==null?void 0:h.map(m=>t(bt,{size:"sm",borderRadius:"full",variant:"solid",colorScheme:"green",mx:"0.25rem",my:"0.2rem",children:t(Ot,{children:m})},`collection-group-list-${m}`))}),((f=a==null?void 0:a.data)==null?void 0:f.isExternal)?null:p(he,{children:[t(fe,{as:"h4",size:"md",mb:"4",children:"Password"}),p("form",{children:[t("input",{className:ne(kt,"input",[o]),id:"current-password-input",type:"password",placeholder:"Current Password...",value:e.currentPassword,onChange:m=>n(u(i({},e),{currentPassword:m.target.value}))}),t("input",{className:ne(kt,"input",[o]),id:"new-password-input",type:"password",placeholder:"New Password...",value:e.newPassword,onChange:m=>n(u(i({},e),{newPassword:m.target.value}))}),t("input",{className:ne(kt,"input",[o]),id:"repeat-password-input",type:"password",placeholder:"Repeat Password...",value:e.repeatPassword,onChange:m=>n(u(i({},e),{repeatPassword:m.target.value}))}),t(Ee,{mt:"4",borderRadius:20,colorScheme:"green",disabled:!e.currentPassword||!e.newPassword||e.repeatPassword!==e.newPassword,onClick:l,children:"Change password"})]})]})]})},Ys="_fileInput_i1zyh_1";var Xs={fileInput:Ys,"fileInput--light":"_fileInput--light_i1zyh_20","fileInput--dark":"_fileInput--dark_i1zyh_24"};const Js=()=>{const[e,n]=g.exports.useState({acknowledge:!1}),{colorMode:o}=se(),{setUser:a}=g.exports.useContext(_e),r=re();async function s(){try{const c=new FormData;if(c.append("File",e.backupfile,"yaade-db.mv.db"),(await fetch(M+"api/user/importBackup",{method:"POST",body:c})).status!==200)throw new Error;a(void 0)}catch{H("Failed to import backup",r)}}async function l(){try{const c=await fetch(M+"api/user/exportBackup");if(c.status!==200)throw new Error;const d=await c.blob();let h=window.URL.createObjectURL(d),f=document.createElement("a");f.href=h,f.download="yaade-db.mv.db",f.click()}catch{H("Data could not be exported.",r)}}return p(Ze,{name:"Admin",children:[t(fe,{as:"h4",size:"md",mb:"2",mt:"2",children:"Export Backup"}),t(Re,{children:"Export your entire Yaade data into a single file that can be used to restore your data."}),t(Ee,{mt:"4",borderRadius:20,colorScheme:"green",w:150,onClick:l,children:"Export"}),t(fe,{as:"h4",size:"md",mb:"2",mt:"4",children:"Import Backup"}),t(Re,{children:"Import a backup file. Make sure to backup your data before importing or else data could be lost."}),t("input",{className:ne(Xs,"fileInput",[o]),type:"file",accept:".db",onChange:c=>{const d=c.target.files?c.target.files[0]:void 0;n(u(i({},e),{backupfile:d}))}}),t(En,{mt:"4",colorScheme:"green",onChange:c=>n(u(i({},e),{acknowledge:c.target.checked})),children:t(Re,{fontSize:12,children:"I acknowledge that importing a backup file will result in a complete loss of my current data with no way of recovery."})}),t(Ee,{mt:"4",borderRadius:20,colorScheme:"green",disabled:!e.backupfile||!e.acknowledge,w:150,onClick:s,children:"Import"})]})},Zs="_fileInput_den10_1",ei="_fieldLabel_den10_32",ti="_formField_den10_36";var Ge={fileInput:Zs,"fileInput--light":"_fileInput--light_den10_22","fileInput--dark":"_fileInput--dark_den10_27",fieldLabel:ei,formField:ti};const pn={host:"",type:"pem",groups:[]},ni=()=>{var _,C;const[e,n]=g.exports.useState({certificates:[],showAddCertificate:!1}),[o,a]=g.exports.useState(pn),{colorMode:r}=se(),s=re(),l=g.exports.useRef(null),c=g.exports.useRef(null);g.exports.useEffect(()=>{(async()=>{try{const E=(await(await fetch(M+"api/certificates")).json()).certificates;n(A=>u(i({},A),{certificates:E}))}catch{H("Certificate could not be fetched.",s)}})()},[s]);async function d(){try{const y=new FormData;y.append("host",o.host),y.append("type",o.type),o.groups.length>0&&y.append("groups",o.groups.join(",")),o.type==="pem"&&o.pemCert&&y.append("pemCert",o.pemCert),o.type==="pem"&&o.pemKey&&y.append("pemKey",o.pemKey);const w=await fetch(M+"api/certificates",{method:"POST",body:y});if(w.status===200){const R=await w.json();n(u(i({},e),{certificates:[...e.certificates,R]})),a(pn),l.current.value="",c.current.value="",Y("Certificate created",s)}else if(w.status===409)H("Certificate already exists",s);else throw new Error}catch{H("Certificate could not be created",s)}}function h(y){try{fetch(M+"api/certificates/"+y,{method:"DELETE"}),n(w=>u(i({},w),{certificates:w.certificates.filter(R=>R.id!==y)})),Y("Certificate deleted",s)}catch{H("Certificate could not be deleted.",s)}}function f(y){a(i({},y))}function m(){return!(o.host===""||o.type==="pem"&&!o.pemCert)}return p(Ze,{name:"Certificates",children:[t(Re,{mb:"4",children:"Upload SSL certificates to be used by the server proxy for matching hostnames. Limit access to certificates via groups."}),t(An,{maxHeight:"160px",overflowY:"scroll",children:p(Qn,{size:"sm",whiteSpace:"normal",children:[t(Un,{children:p(rt,{children:[t(Ke,{p:"0",width:"300px",maxWidth:"350px",children:"Host"}),t(Ke,{p:"0",width:"240px",maxWidth:"240px",children:"Groups"}),t(Ke,{width:"110px",maxWidth:"110px",isNumeric:!0})]})}),t(qn,{children:((_=e.certificates)==null?void 0:_.length)==0?t("div",{style:{marginTop:"5px"},children:t("span",{children:" No certificates"})}):(C=e.certificates)==null?void 0:C.map((y,w)=>p(rt,{children:[t(Ie,{p:"0",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"150px",maxWidth:"150px",overflow:"hidden",verticalAlign:"top",padding:"12px 0 0 0",children:y.data.host}),t(Ie,{p:"0",overflowX:"hidden",verticalAlign:"top",padding:"8px 0 0 0",children:y.data.groups.map(R=>t(bt,{size:"sm",borderRadius:"full",variant:"solid",colorScheme:"green",mr:"0.5rem",my:"0.2rem",children:t(Ot,{children:R})},`certificate-list-${w}-${R}`))}),t(Ie,{p:"0",isNumeric:!0,verticalAlign:"top",children:t(B,{"aria-label":"delete-row",isRound:!0,variant:"ghost",onClick:()=>h(y.id),color:r==="light"?"red.500":"red.300",icon:t(Ne,{})})})]},`certificate-list-${w}`))})]})}),t("hr",{style:{marginTop:"10px"}}),p("div",{style:{marginTop:"10px"},children:[t(fe,{as:"h4",size:"md",mb:"2",mt:"4",children:"Add a new Certificate"}),t(we,{size:"sm",placeholder:"Host",mb:"2",backgroundColor:r==="light"?"white":void 0,value:o.host,onChange:y=>f(u(i({},o),{host:y.target.value}))}),p(Se,{alignItems:"start",children:[t(Ue,{id:"type",value:o.type,size:"sm",onChange:y=>{f(u(i({},o),{type:y.target.value}))},children:t("option",{value:"pem",children:"pem"},"pem")}),t(Xe,{groups:o.groups,setGroups:y=>{f(u(i({},o),{groups:y}))}})]}),p(Se,{mb:"2",children:[t("label",{htmlFor:"pemCert",className:Ge.fieldLabel,style:{width:"160px"},children:"Pem Certificate"}),t("input",{id:"pemCert",ref:l,className:`${ne(Ge,"fileInput",[r])} ${Ge.formField}`,type:"file",onChange:y=>{const w=y.target.files?y.target.files[0]:void 0;!w||f(u(i({},o),{pemCert:w}))}})]}),p(Se,{mb:"4",children:[t("label",{htmlFor:"pemKey",className:Ge.fieldLabel,style:{width:"160px"},children:"Pem Key"}),t("input",{id:"pemKey",ref:c,className:`${ne(Ge,"fileInput",[r])} ${Ge.formField}`,type:"file",onChange:y=>{const w=y.target.files?y.target.files[0]:void 0;!w||f(u(i({},o),{pemKey:w}))}})]}),t(Ee,{mt:"4",borderRadius:20,colorScheme:"green",w:150,onClick:d,disabled:!m(),children:"Add"})]})]})},oi=()=>{var l,c,d,h,f,m,_,C;const{colorMode:e,setColorMode:n}=se(),{user:o,setUser:a}=g.exports.useContext(_e),r=re();async function s(y,w){try{if((await fetch(M+"api/user/changeSetting",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({key:y,value:w})})).status!==200)throw new Error;a(u(i({},o),{data:u(i({},o==null?void 0:o.data),{settings:u(i({},o==null?void 0:o.data.settings),{[y]:w})})})),Y("Settings saved.",r)}catch{H("Setting could not be changed.",r)}}return p(Ze,{name:"General",children:[p(fe,{as:"h4",size:"md",mb:"2",children:["Theme (",e,")"]}),p($n,{direction:"row",alignItems:"center",children:[t(B,{"aria-label":"add-collection-button",icon:t(Lo,{}),onClick:()=>n("light"),variant:"ghost",color:e==="light"?"green":"gray"}),t(B,{"aria-label":"add-collection-button",icon:t($o,{}),onClick:()=>n("dark"),variant:"ghost",colorScheme:e==="dark"?"green":"gray"})]}),t(fe,{as:"h4",size:"md",mb:"4",mt:"4",children:"Behavior"}),p(Se,{mb:"2",children:[t(Re,{w:"200px",children:"Save after successful send"}),t(pt,{colorScheme:"green",size:"md",onChange:y=>s("saveOnSend",y.target.checked),isChecked:(c=(l=o==null?void 0:o.data)==null?void 0:l.settings)==null?void 0:c.saveOnSend,children:((h=(d=o==null?void 0:o.data)==null?void 0:d.settings)==null?void 0:h.saveOnSend)?"ON":"OFF"})]}),p(Se,{children:[t(Re,{w:"200px",children:"Save on close"}),t(pt,{colorScheme:"green",size:"md",onChange:y=>s("saveOnClose",y.target.checked),isChecked:(m=(f=o==null?void 0:o.data)==null?void 0:f.settings)==null?void 0:m.saveOnClose,children:((C=(_=o==null?void 0:o.data)==null?void 0:_.settings)==null?void 0:C.saveOnClose)?"ON":"OFF"})]})]})},ai="_container_qt50g_1",ri="_tabListWrapper_qt50g_6";var Pt={container:ai,tabListWrapper:ri};const si=()=>{const{colorMode:e}=se(),n=re(),[o,a]=g.exports.useState(""),{setUser:r}=g.exports.useContext(_e);g.exports.useEffect(()=>{(async()=>{try{const f=await(await fetch(M+"api/config/auth_config")).json();a(l(f))}catch{H("Auth providers could not be fetched.",n)}})()},[n]);const s=g.exports.useCallback(d=>{a(d)},[]);function l(d){return at(JSON.stringify(d),{format:"json"})}async function c(){var d;try{const h=await fetch(M+"api/config/auth_config",{method:"PUT",headers:{"Content-Type":"application/json"},body:o});if(h.status!==200){const f=await h.json();throw Error((d=f.message)!=null?d:"An unknown error occured")}Y("Saved auth config. Server will now restart!",n),setTimeout(()=>{r(void 0)},3e3)}catch(h){H(`${h}`,n,4e3)}}return p(Ye,{alignItems:"flex-start",w:"100%",children:[t(Ft,{value:o,onChange:s,extensions:[Zt()],theme:e,style:{height:"350px",width:"100%"}}),t(Se,{children:t(Ee,{onClick:c,children:"Save"})})]})},ii=({users:e,setUsers:n})=>{var R;const[o,a]=g.exports.useState({i:-1,groups:[]}),[r,s]=g.exports.useState({username:"",groups:[]}),{isOpen:l,onOpen:c,onClose:d}=ke(),{colorMode:h}=se(),{user:f}=g.exports.useContext(_e),m=re();function _(E){var k,j;const P=(j=(k=e[E].data)==null?void 0:k.groups)!=null?j:[];a(u(i({},o),{i:E,groups:P}))}async function C(E,A){try{const P={username:E,groups:A},k=await fetch(M+"api/users",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify(P)});if(k.status===200){Y("User created",m);const D=await(await fetch(M+"api/users")).json();s(u(i({},r),{username:"",groups:[]})),n(D)}else if(k.status===409)H("User already exists",m);else throw new Error("Could not create user")}catch{H("User could not be created",m)}}async function y(){try{if(o.i===-1)return;const E=e[o.i];if(E.data.groups=o.groups,(await fetch(M+`api/users/${E.id}`,{method:"PUT",headers:{"Content-type":"application/json"},body:JSON.stringify(E)})).status!==200)throw new Error("Could not save user");const P=e;P[o.i]=E,n(P),a(u(i({},o),{i:-1}))}catch{H("Failed to save",m),a(u(i({},o),{i:-1}))}}async function w(){var E;try{const A=(E=o.deleteUser)==null?void 0:E.id;if(!A)throw new Error("User id has to be set");if((await fetch(M+`api/users/${A}`,{method:"DELETE"})).status===200){const k=e.filter(j=>j.id!==A);a(u(i({},o),{deleteUser:void 0})),n(k),Y("User deleted",m),d()}else throw new Error("Failed to delete user")}catch{H("Could not delete user",m)}}return p(he,{children:[t(fe,{as:"h4",size:"md",mb:"2",mt:"2",children:"Add a new user"}),p(Se,{mb:"4",alignItems:"start",children:[t(we,{size:"sm",placeholder:"Username",width:"130px",value:r.username,onChange:E=>s(u(i({},r),{username:E.target.value})),backgroundColor:h==="light"?"white":void 0}),t(Ye,{alignItems:"start",width:"320px",children:t(Xe,{groups:r.groups,setGroups:E=>s(u(i({},r),{groups:E}))})}),t("div",{children:t(B,{"aria-label":"add-new-user",isRound:!0,variant:"ghost",size:"sm",disabled:r.username==="",onClick:()=>C(r.username,r.groups),colorScheme:"green",icon:t(Fe,{})})})]}),t(An,{height:"330px",overflowY:"scroll",children:p(Qn,{size:"sm",whiteSpace:"normal",children:[t(Un,{children:p(rt,{children:[t(Ke,{p:"0",width:"150px",maxWidth:"150px",children:"Username"}),t(Ke,{p:"0",width:"240px",maxWidth:"240px",children:"Groups"}),t(Ke,{width:"110px",maxWidth:"110px",isNumeric:!0})]})}),t(qn,{children:e.map((E,A)=>{var P,k;return o.i===A?p(rt,{children:[t(Ie,{p:"0",verticalAlign:"top",padding:"12px 0 0 0",children:E.username}),t(Ie,{p:"0",verticalAlign:"top",padding:"4px 0 0 0",children:t(Xe,{groups:o.groups,setGroups:j=>a(u(i({},o),{groups:j}))})}),t(Ie,{p:"0",verticalAlign:"top",children:p("div",{style:{display:"flex",justifyContent:"end"},children:[t(B,{"aria-label":"save-user-edit",isRound:!0,variant:"ghost",onClick:y,colorScheme:"green",icon:t(Fe,{})}),t(B,{"aria-label":"cancel-user-edit",isRound:!0,variant:"ghost",onClick:()=>a(u(i({},o),{i:-1})),colorScheme:"red",icon:t(ft,{})})]})})]},`admin-user-list-${A}`):p(rt,{children:[t(Ie,{p:"0",textOverflow:"ellipsis",whiteSpace:"nowrap",width:"150px",maxWidth:"150px",overflow:"hidden",verticalAlign:"top",padding:"12px 0 0 0",children:E.username}),t(Ie,{p:"0",overflowX:"hidden",verticalAlign:"top",padding:"8px 0 0 0",children:(k=(P=E.data)==null?void 0:P.groups)==null?void 0:k.map(j=>t(bt,{size:"sm",borderRadius:"full",variant:"solid",colorScheme:"green",mr:"0.5rem",my:"0.2rem",children:t(Ot,{children:j})},`admin-user-list-${A}-${j}`))}),p(Ie,{p:"0",isNumeric:!0,verticalAlign:"top",children:[t(B,{"aria-label":"edit-row",isRound:!0,variant:"ghost",onClick:()=>_(A),icon:t(Kt,{})}),t(B,{"aria-label":"delete-row",isRound:!0,variant:"ghost",onClick:()=>{a(u(i({},o),{deleteUser:E})),c()},disabled:E.username===(f==null?void 0:f.username),color:h==="light"?"red.500":"red.300",icon:t(Ne,{})})]})]},`admin-user-list-${A}`)})})]})}),t(Te,{isOpen:l,initialRef:void 0,onClose:d,heading:`Delete "${(R=o.deleteUser)==null?void 0:R.username}"`,onClick:w,buttonText:"Delete",buttonColor:"red",isButtonDisabled:!1,children:"Are you sure you want to delete this user?"})]})},ci=()=>{const[e,n]=g.exports.useState({users:[]}),o=re();g.exports.useEffect(()=>{(async()=>{try{const c=await(await fetch(M+"api/users")).json();n(d=>u(i({},d),{users:c}))}catch{H("Users could not be fetched.",o)}})()},[]);function a(s){n(l=>u(i({},l),{users:s}))}function r(){const s=/^.*\$.*$/;return e.users.filter(l=>!l.username.match(s))}return t(Ze,{name:"Users",children:p(qe,{isLazy:!0,colorScheme:"green",mt:"1",display:"flex",flexDirection:"column",maxHeight:"100%",h:"100%",mb:"4",children:[p(He,{children:[t(Z,{children:"Local"}),t(Z,{children:"External"})]}),p(Me,{overflowY:"auto",sx:{scrollbarGutter:"stable"},h:"100%",children:[t(ee,{children:t(ii,{users:r(),setUsers:a})}),t(ee,{h:"100%",children:t(si,{})})]})]})})},Be={borderRadius:"0 20px 20px 0",borderWidth:"0px",justifyContent:"start",paddingLeft:"2rem",boxSizing:"border-box"};function li(){const{isAdmin:e}=g.exports.useContext(_e),{colorMode:n}=se(),o={bg:n==="light"?"gray.200":"gray.800",borderLeft:"4px solid var(--chakra-colors-green-500)",boxSizing:"border-box"};return t("div",{className:Pt.container,children:p(qe,{isLazy:!0,colorScheme:"green",orientation:"vertical",size:"lg",tabIndex:-1,children:[t("div",{className:Pt.tabListWrapper,children:p(He,{className:Pt.tabs,sx:{borderLeft:"0px"},tabIndex:-1,children:[t(Z,{sx:Be,_selected:o,tabIndex:-1,children:"General"}),t(Z,{sx:Be,_selected:o,children:"Account"}),e()?p(he,{children:[t(st,{my:"4"}),t(Z,{sx:Be,_selected:o,children:"Backup"}),t(Z,{sx:Be,_selected:o,children:"Users"}),t(st,{my:"4"})]}):null,t(Z,{sx:Be,_selected:o,children:"Certificates"}),t(Z,{sx:Be,_selected:o,children:"About"})]})}),p(Me,{tabIndex:-1,children:[t(ee,{tabIndex:-1,children:t(oi,{})}),t(ee,{children:t(Ws,{})}),e()?t(ee,{children:t(Js,{})}):null,e()?t(ee,{children:t(ci,{})}):null,t(ee,{children:t(ni,{})}),t(ee,{children:p(Ze,{name:"About",children:["From Munich with \u2764\uFE0F",t("br",{}),t("br",{}),"Created by Jonathan R\xF6sner at EsperoTech."]})})]})]})})}const di="_container_dj1nc_1",ui="_buttons_dj1nc_9",hi="_img_dj1nc_13";var Rt={container:di,buttons:ui,img:hi};const pi="_img_1co2j_1";var fi={img:pi};function mi(){const{isOpen:e,onOpen:n,onClose:o}=ke(),a=[{icon:qo,link:"#/home",id:"1-home",text:"Home"},{icon:Ho,link:"#/history",id:"2-api-history",text:"History"},{icon:Mo,link:"#/logs",id:"3-api-history",text:"Logs"},{icon:jo,link:"#/instresults",id:"4-int-results",text:"Intrusion results"}];return p(he,{children:[t(Ye,{spacing:"5",as:"nav",display:{base:"none",md:"flex"},children:t(an,{onClick:n,as:Ln,boxSize:10,style:{margin:"10px",padding:"0px 5px ",cursor:"pointer"}})}),p(Ao,{placement:"left",onClose:o,isOpen:e,children:[t(Ct,{}),p(Qo,{children:[t(zt,{}),t(jt,{borderBottomWidth:"1px",children:p(Se,{children:[t("img",{className:fi.img,src:"yaade-icon.png",alt:"yaade icon"}),t(fe,{as:"h1",size:"md",ml:"2",children:"YAADE"})]})}),t(Vt,{children:t(Ye,{children:a.map(r=>t(Uo,{display:"block",href:r.link,onClick:o,_focus:{bg:"green.100"},_hover:{bg:"green.200",color:"black"},_activeLink:{bg:"orange.500",color:"red"},w:"full",borderRadius:"md",children:p(qt,{alignItems:"center",p:2,children:[t(an,{boxSize:"5",as:r.icon}),t(Re,{style:{paddingLeft:"5px"},children:r.text})]})},r.id))})})]})]})]})}function gi(){const{isOpen:e,onOpen:n,onClose:o}=ke();return p(Je,{className:Rt.container,bg:"headerBg",borderBottom:"1px",borderColor:"rgba(128, 128, 128, 0.35)",children:[t(mi,{}),t("img",{className:Rt.img,src:"yaade-icon.png",alt:"yaade icon"}),t(fe,{as:"h1",size:"md",ml:"2",children:"YAADE"}),t("div",{className:Rt.buttons,children:t(B,{"aria-label":"settings-button",icon:t(zo,{}),onClick:n,variant:"ghost"})}),p(Ht,{isOpen:e,onClose:o,children:[t(Ct,{}),t(Mt,{width:"",maxWidth:"",borderRadius:20,padding:2,children:t(li,{})})]})]})}function vi(){return t(he,{children:t("h1",{children:"Logs page here !"})})}function wi(){return t(he,{children:t("h1",{children:"Settings page here !"})})}const yi=Vo([{path:"*",element:t(hn,{})},{path:"/home",element:t(hn,{})},{path:"/history",element:t(Gs,{})},{path:"/logs",element:t(vi,{})},{path:"/settings",element:t(wi,{})}]);function Ci(){return p(he,{children:[t("header",{children:t(gi,{})}),t(Go,{router:yi})]})}const ht=30;function bi(){return t(Bo,{theme:fa,children:t(Xo,{children:t(Oi,{})})})}function Oi(){const{user:e,setUser:n}=g.exports.useContext(_e),[o,a]=g.exports.useState(ht),r=re(),s=g.exports.useRef();function l(f){s.current&&r.update(s.current,{description:`No connection to server. Logout in ${f}`,duration:null,position:"top"})}function c(){s.current=r({description:`No connection to server. Logout in ${o}`,duration:null,position:"top"})}function d(){r({description:"Connection to server restored",status:"success",isClosable:!1,duration:3e3,position:"top"})}function h(){r.closeAll(),s.current=void 0}return Fo(async()=>{if(e)try{if((await fetch(M+"api/user")).status===200)s.current&&(h(),d(),a(ht));else throw new Error("No connection to server...")}catch{if(s.current)if(o===0)n(void 0),a(ht),h();else{const m=o-1;a(m),l(m)}else c()}else a(ht),h()},1e3),e?t(Ci,{}):t(ua,{})}Ko.render(t(bi,{}),document.getElementById("root"));
